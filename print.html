<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title></title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="book.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="index.html">Home</a></li><li class="chapter-item affix "><li class="part-title">contracts</li><li class="chapter-item "><a href="contracts/src/index.html">❱ src</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/src/interfaces/index.html">❱ interfaces</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/src/interfaces/AbstractStakeTable.sol/abstract.AbstractStakeTable.html">AbstractStakeTable</a></li><li class="chapter-item "><a href="contracts/src/interfaces/IPlonkVerifier.sol/interface.IPlonkVerifier.html">IPlonkVerifier</a></li></ol></li><li class="chapter-item "><a href="contracts/src/legacy/index.html">❱ legacy</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/src/legacy/Transcript.sol/library.Transcript.html">Transcript</a></li></ol></li><li class="chapter-item "><a href="contracts/src/libraries/index.html">❱ libraries</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="contracts/src/libraries/BLSSig.sol/library.BLSSig.html">BLSSig</a></li><li class="chapter-item "><a href="contracts/src/libraries/EdOnBn254.sol/library.EdOnBN254.html">EdOnBN254</a></li><li class="chapter-item "><a href="contracts/src/libraries/LightClientStateUpdateVK.sol/library.LightClientStateUpdateVK.html">LightClientStateUpdateVK</a></li><li class="chapter-item "><a href="contracts/src/libraries/PlonkVerifier.sol/library.PlonkVerifier.html">PlonkVerifier</a></li><li class="chapter-item "><a href="contracts/src/libraries/PlonkVerifier2.sol/library.PlonkVerifier2.html">PlonkVerifier2</a></li><li class="chapter-item "><a href="contracts/src/libraries/PolynomialEval.sol/library.PolynomialEval.html">PolynomialEval</a></li></ol></li><li class="chapter-item "><a href="contracts/src/ExampleToken.sol/contract.ExampleToken.html">ExampleToken</a></li><li class="chapter-item "><a href="contracts/src/FeeContract.sol/contract.FeeContract.html">FeeContract</a></li><li class="chapter-item "><a href="contracts/src/LightClient.sol/contract.LightClient.html">LightClient</a></li><li class="chapter-item "><a href="contracts/src/StakeTable.sol/contract.StakeTable.html">StakeTable</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/EspressoSystems/espresso-sequencer" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="espresso-sequencer"><a class="header" href="#espresso-sequencer">Espresso Sequencer</a></h1>
<p><a href="https://github.com/EspressoSystems/espresso-sequencer/actions/workflows/build.yml"><img src="https://github.com/EspressoSystems/espresso-sequencer/actions/workflows/build.yml/badge.svg" alt="Build" /></a>
<a href="https://github.com/EspressoSystems/espresso-sequencer/actions/workflows/test.yml"><img src="https://github.com/EspressoSystems/espresso-sequencer/actions/workflows/test.yml/badge.svg" alt="Test" /></a>
<a href="https://github.com/EspressoSystems/espresso-sequencer/actions/workflows/doc-rust.yml"><img src="https://github.com/EspressoSystems/espresso-sequencer/actions/workflows/doc-rust.yml/badge.svg" alt="Docs rust" /></a>
<a href="https://github.com/EspressoSystems/espresso-sequencer/actions/workflows/doc-contracts.yml"><img src="https://github.com/EspressoSystems/espresso-sequencer/actions/workflows/doc-contracts.yml/badge.svg" alt="Docs contracts" /></a>
<a href="https://github.com/EspressoSystems/espresso-sequencer/actions/workflows/contracts.yml"><img src="https://github.com/EspressoSystems/espresso-sequencer/actions/workflows/contracts.yml/badge.svg" alt="Contracts" /></a>
<a href="https://github.com/EspressoSystems/espresso-sequencer/actions/workflows/lint.yml"><img src="https://github.com/EspressoSystems/espresso-sequencer/actions/workflows/lint.yml/badge.svg" alt="Lint" /></a>
<a href="https://github.com/EspressoSystems/espresso-sequencer/actions/workflows/audit.yml"><img src="https://github.com/EspressoSystems/espresso-sequencer/actions/workflows/audit.yml/badge.svg" alt="Audit" /></a>
<a href="https://github.com/EspressoSystems/espresso-sequencer/actions/workflows/ubuntu-install-without-nix.yml"><img src="https://github.com/EspressoSystems/espresso-sequencer/actions/workflows/ubuntu-install-without-nix.yml/badge.svg" alt="Ubuntu" /></a>
<a href="https://coveralls.io/github/EspressoSystems/espresso-sequencer?branch=main"><img src="https://coveralls.io/repos/github/EspressoSystems/espresso-sequencer/badge.svg?branch=main" alt="Coverage Status" /></a></p>
<p>The Espresso Sequencer offers rollups credible neutrality and enhanced interoperability, without compromising on scale.
Consisting of a data availability solution and a decentralized network of nodes that sequences transactions, layer-2
rollups can leverage the Espresso Sequencer to give developers and end users fast confirmations, low (and fair) fees,
and robust infrastructure.</p>
<p><a href="https://docs.espressosys.com/sequencer/espresso-sequencer-architecture/readme">Official Documentation</a></p>
<h3 id="architecture"><a class="header" href="#architecture">Architecture</a></h3>
<p>This diagram below depicts a simplified view of the current architecture of the Espresso Sequencer. The diagram includes
views of an Espresso Sequencer node, the Espresso Sequencer Network (nodes, CDN, builders, prover, state relay service),
two rollups (one ZK rollup "Z", one optimistic rollup "O") that use the Espresso Sequencer for sequencing and some
important L1 contracts.</p>
<ul>
<li>Glossary
<ul>
<li>Namespace: an identifier to distinguish rollups, akin to an Ethereum chain ID</li>
<li>Rollup transaction: a transaction a user submits to a rollup, usually an EVM transaction</li>
<li>Transaction: a transaction inside the Espresso Sequencer: a rollup transaction plus a namespace ID of the rollup</li>
<li>Rollup block: a block in a rollup consisting only of transactions in this rollup</li>
<li>Espresso block: a block produced by the Espresso sequencer containing transactions of multiple rollups</li>
</ul>
</li>
</ul>
<p><img src="./doc/architecture.svg" alt="Architecture diagram" /></p>
<p>The sequence diagram below serves as a complement to the architecture diagram. The following interactions are depicted.</p>
<ol>
<li>Builders deposit funds into the fee contract on Ethereum Layer 1. These funds are later used to pay fees.</li>
<li>Users submit transactions to the Submit APIs of sequencer nodes.</li>
<li>The leader/proposer obtains a block from a builder.</li>
<li>HotShot consensus creates new blocks containing sequenced rollup transactions.</li>
<li>A rollup produces a rollup block with transactions sequenced by the Espresso sequencer.</li>
<li>A proof for a HotShot state update is created and verified in the Light Client smart contract.</li>
<li>A ZK rollup proves a correct state transaction by sending a proof to its rollup smart contract.</li>
<li>A dispute is settled in an optimistic rollup. If necessary, the HotShot commitment is read from the Light Client
contract.</li>
</ol>
<p><img src="./doc/sequence-diagram.svg" alt="Sequence diagram" /></p>
<h4 id="zk-rollups-integration"><a class="header" href="#zk-rollups-integration">ZK rollups integration</a></h4>
<p>In order for ZK rollups to rely on blocks produced by Espresso as a source of transactions, it is required to adjust the
circuit that encodes the state update logic. See <a href="doc/zk-integration.html">zk-rollups integration</a> for more details.</p>
<h1 id="running-the-demo"><a class="header" href="#running-the-demo">Running the demo</a></h1>
<p>Refer to <a href="https://github.com/EspressoSystems/sequencer-example-l2">sequencer-example-l2</a> for instructions on how to run
a dockerized Espresso Sequencer network with an example Layer 2 rollup application.</p>
<h1 id="development"><a class="header" href="#development">Development</a></h1>
<ul>
<li>Obtain code: <code>git clone git@github.com:EspressoSystems/espresso-sequencer</code>.</li>
<li>Make sure <a href="https://nixos.org/download.html">nix</a> is installed.</li>
<li>Activate the environment with <code>nix-shell</code>, or <code>nix develop</code>, or <code>direnv allow</code> if using <a href="https://direnv.net/">direnv</a>.</li>
<li>For installation without nix please see <a href="./doc/ubuntu.html">ubuntu.md</a>.</li>
</ul>
<h2 id="documentation"><a class="header" href="#documentation">Documentation</a></h2>
<p>The rust code documentation can be found at
<a href="https://sequencer.docs.espressosys.com">sequencer.docs.espressosys.com</a>. Please note the disclaimer about API
stability at the end of the readme.</p>
<p>To generate the documentation locally and view it in the browser, run</p>
<pre><code>just doc --open
</code></pre>
<h2 id="run-the-tests"><a class="header" href="#run-the-tests">Run the tests</a></h2>
<pre><code>just pull # to pull docker images
just test
</code></pre>
<h2 id="building-figures"><a class="header" href="#building-figures">Building figures</a></h2>
<pre><code>make doc
</code></pre>
<h2 id="building-and-running"><a class="header" href="#building-and-running">Building and running</a></h2>
<p>Docker images and the <a href="docker-compose-demo.yaml">docker-compose-demo.yaml</a> file are provided for convenience. The
Docker-based demo fetches the images from the <code>ghcr</code> repository, where they are updated with every push to <code>main</code> on
GitHub. For testing uncommitted changes, you can also run the binaries by manually building and running the services.</p>
<p>Build all executables with <code>cargo build --release</code>. You may then start a sequencer network. First, start an
orchestrator. Choose a port <code>$PORT</code> to run it on and decide how many sequencer nodes <code>$N</code> you will use, then run
<code>target/release/orchestrator -p $PORT -n $N</code>.</p>
<p>The sequencer will distribute a HotShot configuration to all the nodes which connect to it, which specifies consensus
parameters like view timers. There is a default config, but you can override any parameters you want by passing
additional options to the <code>orchestrator</code> executable. Run <code>target/release/orchestrator --help</code> to see a list of available
options.</p>
<p>Next, you must launch a <code>cdn</code> instance, which is necessary to facilitate consensus.</p>
<pre><code class="language-bash">just dev-cdn -- -p 1738
</code></pre>
<p>In this case, we run it on port 1738.</p>
<p>Once you have started the orchestrator and the CDN, you must connect <code>$N</code> sequencer nodes to them, after which the
network will start up automatically. To start one node, run</p>
<pre><code class="language-bash">target/release/sequencer \
    --orchestrator-url http://localhost:$PORT \
    --cdn-endpoint "127.0.0.1:1738"  \
    -- http --port 8083 -- query --storage-path storage -- submit
</code></pre>
<p>A useful Bash snippet for running <code>$N</code> nodes simultaneously in the background of your shell is:</p>
<pre><code class="language-bash">for i in `seq $N`; do
    target/release/sequencer \
        --orchestrator-url http://localhost:$PORT \
        --cdn-endpoint "127.0.0.1:1738"  \
done
</code></pre>
<p>For running a full demo natively run <code>just demo-native</code>.</p>
<h3 id="contracts"><a class="header" href="#contracts">Contracts</a></h3>
<h4 id="development-1"><a class="header" href="#development-1">Development</a></h4>
<p>A foundry project for the contracts specific to HotShot can be found in the directory <code>contracts</code>.</p>
<p>To compile</p>
<pre><code class="language-shell">forge build
</code></pre>
<p>To run the tests</p>
<pre><code class="language-shell">forge test
</code></pre>
<p>In order to avoid constant warnings about checksum mismatches with <a href="https://github.com/roynalnaruto/svm-rs">svm-rs</a>
managed <code>solc</code> we set <code>FOUNDRY_SRC</code> to solc installed via flake.nix.</p>
<ul>
<li>To use the contracts from rust generate the rust contracts bindings: <code>just gen-bindings</code>.</li>
<li>Bindings are only generated for contracts in the <code>contracts/src</code> folder</li>
</ul>
<p>To generate documentation in <code>./docs</code> for solidity code run</p>
<pre><code class="language-shell">forge doc
</code></pre>
<h4 id="deployment"><a class="header" href="#deployment">Deployment</a></h4>
<p>To deploy the contracts to a local testnet, first run a dev chain (e.g. <code>anvil</code>), then run</p>
<pre><code>forge script DeployHotShot --broadcast --rpc-url local
</code></pre>
<p>To deploy to sepolia set <code>SEPOLIA_RPC_URL</code> and <code>MNEMONIC</code> env vars and run</p>
<pre><code>forge script DeployHotShot --broadcast --rpc-url sepolia
</code></pre>
<p>To additionally verify the contact on etherscan set the <code>ETHERSCAN_API_KEY</code> env var and run</p>
<pre><code>forge script DeployHotShot --broadcast --rpc-url sepolia --verify
</code></pre>
<p>Running the script will save a file with details about the deployment in <code>contracts/broadcast/$CHAIN_ID</code>.</p>
<h4 id="folder-structure-rationale"><a class="header" href="#folder-structure-rationale">Folder Structure Rationale</a></h4>
<ul>
<li>code for demo purposes goes into the <code>contracts/demo</code> folder</li>
<li>code that eventually ends up in production goes into the <code>contracts/src</code> folder</li>
</ul>
<h4 id="benchmarking-and-profiling"><a class="header" href="#benchmarking-and-profiling">Benchmarking and profiling</a></h4>
<p>The gas consumption for verifying a plonk proof as well as updating the state of the light client contract can be seen
by running:</p>
<pre><code>&gt; just gas-benchmarks
&gt; cat gas-benchmarks.txt
[PASS] test_verify_succeeds() (gas: 507774)
[PASS] testCorrectUpdateBench() (gas: 594533)
</code></pre>
<p>In order to profile the gas consumption of the light client contract do the following:</p>
<ol>
<li>Set the environment variables <code>SEPOLIA_RPC_URL</code>, <code>MNEMONIC</code> and <code>ETHERSCAN_API_KEY</code>.</li>
<li><code>just lc-contract-profiling-sepolia</code></li>
<li>Create an account on <a href="https://app.sentio.xyz/">sentio.xyz</a>.</li>
<li>Use the hash of the transaction generated in step two when calling the function <code>newFinalizedState</code> in order to
obtain the gas profile.</li>
</ol>
<h2 id="misc"><a class="header" href="#misc">Misc</a></h2>
<h3 id="authenticate-with-github-container-registry"><a class="header" href="#authenticate-with-github-container-registry">Authenticate with GitHub container registry</a></h3>
<p>This is only necessary to fetch private images.</p>
<ul>
<li>Go to your github profile</li>
<li>Developer Settings &gt; Personal access tokens &gt; Personal access tokens (classic)</li>
<li>Generate a new token
<ul>
<li>for the scope options of the token, tick the <em>repo</em> box.</li>
</ul>
</li>
<li>Run <code>docker login ghcr.io --username &lt;you_github_id&gt; --password &lt;your_personal_access_token&gt;</code></li>
</ul>
<h1 id="license"><a class="header" href="#license">License</a></h1>
<h2 id="copyright"><a class="header" href="#copyright">Copyright</a></h2>
<p><strong>(c) 2022 Espresso Systems</strong> <code>espresso-sequencer</code> was developed by Espresso Systems. While we plan to adopt an open
source license, we have not yet selected one. As such, all rights are reserved for the time being. Please reach out to
us if you have thoughts on licensing.</p>
<h1 id="disclaimer"><a class="header" href="#disclaimer">Disclaimer</a></h1>
<p><strong>DISCLAIMER:</strong> This software is provided "as is" and its security has not been externally audited. Use at your own
risk.</p>
<p><strong>DISCLAIMER:</strong> The Rust library crates provided in this repository are intended primarily for use by the binary targets
in this repository. We make no guarantees of public API stability. If you are building on these crates, reach out by
opening an issue to discuss the APIs you need.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents"><a class="header" href="#contents">Contents</a></h1>
<ul>
<li><a href="contracts/src//contracts/src/interfaces">interfaces</a></li>
<li><a href="contracts/src//contracts/src/legacy">legacy</a></li>
<li><a href="contracts/src//contracts/src/libraries">libraries</a></li>
<li><a href="contracts/src/ExampleToken.sol/contract.ExampleToken.html">ExampleToken</a></li>
<li><a href="contracts/src/FeeContract.sol/contract.FeeContract.html">FeeContract</a></li>
<li><a href="contracts/src/LightClient.sol/contract.LightClient.html">LightClient</a></li>
<li><a href="contracts/src/StakeTable.sol/contract.StakeTable.html">StakeTable</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-1"><a class="header" href="#contents-1">Contents</a></h1>
<ul>
<li><a href="contracts/src/interfaces/AbstractStakeTable.sol/abstract.AbstractStakeTable.html">AbstractStakeTable</a></li>
<li><a href="contracts/src/interfaces/IPlonkVerifier.sol/interface.IPlonkVerifier.html">IPlonkVerifier</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="abstractstaketable"><a class="header" href="#abstractstaketable">AbstractStakeTable</a></h1>
<p><a href="https://github.com/EspressoSystems/espresso-sequencer/blob/e8acf9c949a2e8444895bbc1fae887b9ef33992c/contracts/src/interfaces/AbstractStakeTable.sol">Git Source</a></p>
<p><em>Stake delegation happens in a separate DelegationPool contract, and specific to
instantiation thus not part of this interface</em></p>
<p><em>Stake table contract should store a reference to the <code>LightClient.sol</code> to query
"epoch-related" info</em></p>
<h2 id="state-variables"><a class="header" href="#state-variables">State Variables</a></h2>
<h3 id="totalkeys"><a class="header" href="#totalkeys">totalKeys</a></h3>
<p>Get the total number of stakers, uniquely identified by their <code>blsVK</code></p>
<pre><code class="language-solidity">uint32 public totalKeys;
</code></pre>
<h3 id="totalvotingstake"><a class="header" href="#totalvotingstake">totalVotingStake</a></h3>
<p>Get the total stake of the registered keys in the voting stake table
(LastEpochStart)</p>
<pre><code class="language-solidity">uint256 public totalVotingStake;
</code></pre>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<h3 id="totalstake"><a class="header" href="#totalstake">totalStake</a></h3>
<p>Total stakes of the registered keys in the latest stake table (Head).</p>
<pre><code class="language-solidity">function totalStake() external view virtual returns (uint256, uint256);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The total stake for native token and restaked token respectively.</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td></td></tr>
</tbody></table>
</div>
<h3 id="lookupstake"><a class="header" href="#lookupstake">lookupStake</a></h3>
<p>Look up the balance of <code>blsVK</code></p>
<pre><code class="language-solidity">function lookupStake(BN254.G2Point memory blsVK) external view virtual returns (uint64);
</code></pre>
<h3 id="lookupnode"><a class="header" href="#lookupnode">lookupNode</a></h3>
<p>Look up the full <code>Node</code> state associated with <code>blsVK</code></p>
<pre><code class="language-solidity">function lookupNode(BN254.G2Point memory blsVK) external view virtual returns (Node memory);
</code></pre>
<h3 id="nextregistrationepoch"><a class="header" href="#nextregistrationepoch">nextRegistrationEpoch</a></h3>
<p>Get the next available epoch and queue size in that epoch</p>
<pre><code class="language-solidity">function nextRegistrationEpoch() external view virtual returns (uint64, uint64);
</code></pre>
<h3 id="numpendingregistrations"><a class="header" href="#numpendingregistrations">numPendingRegistrations</a></h3>
<p>Get the number of pending registration requests in the waiting queue</p>
<pre><code class="language-solidity">function numPendingRegistrations() external view virtual returns (uint64);
</code></pre>
<h3 id="nextexitepoch"><a class="header" href="#nextexitepoch">nextExitEpoch</a></h3>
<p>Get the next available epoch for exit and queue size in that epoch</p>
<pre><code class="language-solidity">function nextExitEpoch() external view virtual returns (uint64, uint64);
</code></pre>
<h3 id="numpendingexits"><a class="header" href="#numpendingexits">numPendingExits</a></h3>
<p>Get the number of pending exit requests in the waiting queue</p>
<pre><code class="language-solidity">function numPendingExits() external view virtual returns (uint64);
</code></pre>
<h3 id="register"><a class="header" href="#register">register</a></h3>
<p>Register a validator in the stake table, transfer of tokens incurred!</p>
<p><em>No validity check on <code>schnorrVK</code>, as it's assumed to be sender's responsibility,
the contract only treat it as auxiliary info submitted by <code>blsVK</code>.</em></p>
<p><em><code>blsSig</code> field is necessary to prevent "rogue public-key attack".
The signature is over the caller address of the function to ensure that each message is
unique.</em></p>
<pre><code class="language-solidity">function register(
    BN254.G2Point memory blsVK,
    EdOnBN254.EdOnBN254Point memory schnorrVK,
    uint64 amount,
    StakeType stakeType,
    BN254.G1Point memory blsSig,
    uint64 validUntilEpoch
) external virtual;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>blsVK</code></td><td><code>BN254.G2Point</code></td><td>The BLS verification key</td></tr>
<tr><td><code>schnorrVK</code></td><td><code>EdOnBN254.EdOnBN254Point</code></td><td>The Schnorr verification key (as the auxiliary info)</td></tr>
<tr><td><code>amount</code></td><td><code>uint64</code></td><td>The amount to register</td></tr>
<tr><td><code>stakeType</code></td><td><code>StakeType</code></td><td>The type of staking (native or restaking)</td></tr>
<tr><td><code>blsSig</code></td><td><code>BN254.G1Point</code></td><td>The BLS signature that authenticates the ethereum account this function is called from</td></tr>
<tr><td><code>validUntilEpoch</code></td><td><code>uint64</code></td><td>The maximum epoch the sender is willing to wait to be included (cannot be smaller than the current epoch)</td></tr>
</tbody></table>
</div>
<h3 id="deposit"><a class="header" href="#deposit">deposit</a></h3>
<p>Deposit more stakes to registered keys</p>
<pre><code class="language-solidity">function deposit(BN254.G2Point memory blsVK, uint64 amount)
    external
    virtual
    returns (uint64, uint64);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>blsVK</code></td><td><code>BN254.G2Point</code></td><td>The BLS verification key</td></tr>
<tr><td><code>amount</code></td><td><code>uint64</code></td><td>The amount to deposit</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint64</code></td><td>(newBalance, effectiveEpoch) the new balance effective at a future epoch</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint64</code></td><td></td></tr>
</tbody></table>
</div>
<h3 id="requestexit"><a class="header" href="#requestexit">requestExit</a></h3>
<p>Request to exit from the stake table, not immediately withdrawable!</p>
<pre><code class="language-solidity">function requestExit(BN254.G2Point memory blsVK) external virtual;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>blsVK</code></td><td><code>BN254.G2Point</code></td><td>The BLS verification key to exit</td></tr>
</tbody></table>
</div>
<h3 id="withdrawfunds"><a class="header" href="#withdrawfunds">withdrawFunds</a></h3>
<p>Withdraw from the staking pool. Transfers occur! Only successfully exited keys can
withdraw past their <code>exitEpoch</code>.</p>
<pre><code class="language-solidity">function withdrawFunds(BN254.G2Point memory blsVK) external virtual returns (uint64);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>blsVK</code></td><td><code>BN254.G2Point</code></td><td>The BLS verification key to withdraw</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint64</code></td><td>The total amount withdrawn, equal to <code>Node.balance</code> associated with <code>blsVK</code></td></tr>
</tbody></table>
</div>
<h2 id="events"><a class="header" href="#events">Events</a></h2>
<h3 id="registered"><a class="header" href="#registered">Registered</a></h3>
<p>Signals a registration of a BLS public key.</p>
<pre><code class="language-solidity">event Registered(
    bytes32 blsVKhash, uint64 registerEpoch, StakeType stakeType, uint256 amountDeposited
);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>blsVKhash</code></td><td><code>bytes32</code></td><td>hash of the BLS public key that is registered.</td></tr>
<tr><td><code>registerEpoch</code></td><td><code>uint64</code></td><td>epoch when the registration becomes effective.</td></tr>
<tr><td><code>stakeType</code></td><td><code>StakeType</code></td><td>native or restake token.</td></tr>
<tr><td><code>amountDeposited</code></td><td><code>uint256</code></td><td>amount deposited when registering the new node.</td></tr>
</tbody></table>
</div>
<h3 id="exit"><a class="header" href="#exit">Exit</a></h3>
<p>Signals an exit request has been granted.</p>
<pre><code class="language-solidity">event Exit(bytes32 blsVKhash, uint64 exitEpoch);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>blsVKhash</code></td><td><code>bytes32</code></td><td>hash of the BLS public key owned by the user who requested to exit.</td></tr>
<tr><td><code>exitEpoch</code></td><td><code>uint64</code></td><td>epoch when the user will be allowed to withdraw its funds.</td></tr>
</tbody></table>
</div>
<h3 id="deposit-1"><a class="header" href="#deposit-1">Deposit</a></h3>
<p>Signals a deposit to a BLS public key.</p>
<pre><code class="language-solidity">event Deposit(bytes32 blsVKhash, uint256 amount);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>blsVKhash</code></td><td><code>bytes32</code></td><td>hash of the BLS public key that received the deposit.</td></tr>
<tr><td><code>amount</code></td><td><code>uint256</code></td><td>amount of the deposit</td></tr>
</tbody></table>
</div>
<h2 id="structs"><a class="header" href="#structs">Structs</a></h2>
<h3 id="node"><a class="header" href="#node">Node</a></h3>
<p>Represents a HotShot validator node
In the dual-staking model, a HotShot validator could have multiple <code>Node</code> entries.</p>
<p><em>(sadly, Solidity doesn't support type alias on non-primitive types)</em></p>
<p><em>BLS verification key (used for Consensus voting in HotShot) is <code>BN254.G2Point</code>.</em></p>
<p><em>Verification key of a Schnorr signature is just a <code>EdOnBN254.EdOnBN254Point</code></em></p>
<pre><code class="language-solidity">struct Node {
    address account;
    StakeType stakeType;
    uint64 balance;
    uint64 registerEpoch;
    uint64 exitEpoch;
    EdOnBN254.EdOnBN254Point schnorrVK;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>account</code></td><td><code>address</code></td><td>The Ethereum account of the validator.</td></tr>
<tr><td><code>stakeType</code></td><td><code>StakeType</code></td><td>The type of token staked.</td></tr>
<tr><td><code>balance</code></td><td><code>uint64</code></td><td>The amount of token staked.</td></tr>
<tr><td><code>registerEpoch</code></td><td><code>uint64</code></td><td>The starting epoch for the validator.</td></tr>
<tr><td><code>exitEpoch</code></td><td><code>uint64</code></td><td>The ending epoch for the validator.</td></tr>
<tr><td><code>schnorrVK</code></td><td><code>EdOnBN254.EdOnBN254Point</code></td><td>The Schnorr verification key associated.</td></tr>
</tbody></table>
</div>
<h2 id="enums"><a class="header" href="#enums">Enums</a></h2>
<h3 id="staketype"><a class="header" href="#staketype">StakeType</a></h3>
<p>Supported stake type, either using native token or re-staked using ETH</p>
<pre><code class="language-solidity">enum StakeType {
    Native,
    Restake
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iplonkverifier"><a class="header" href="#iplonkverifier">IPlonkVerifier</a></h1>
<p><a href="https://github.com/EspressoSystems/espresso-sequencer/blob/e8acf9c949a2e8444895bbc1fae887b9ef33992c/contracts/src/interfaces/IPlonkVerifier.sol">Git Source</a></p>
<h2 id="functions-1"><a class="header" href="#functions-1">Functions</a></h2>
<h3 id="verify"><a class="header" href="#verify">verify</a></h3>
<p><em>Verify a single TurboPlonk proofs.</em></p>
<pre><code class="language-solidity">function verify(
    VerifyingKey memory verifyingKey,
    uint256[8] memory publicInput,
    PlonkProof memory proof
) external view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>verifyingKey</code></td><td><code>VerifyingKey</code></td><td>The Plonk verification key</td></tr>
<tr><td><code>publicInput</code></td><td><code>uint256[8]</code></td><td>The public input fields</td></tr>
<tr><td><code>proof</code></td><td><code>PlonkProof</code></td><td>The TurboPlonk proof</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>_ A boolean indicating successful verification, false otherwise</td></tr>
</tbody></table>
</div>
<h2 id="structs-1"><a class="header" href="#structs-1">Structs</a></h2>
<h3 id="plonkproof"><a class="header" href="#plonkproof">PlonkProof</a></h3>
<pre><code class="language-solidity">struct PlonkProof {
    BN254.G1Point wire0;
    BN254.G1Point wire1;
    BN254.G1Point wire2;
    BN254.G1Point wire3;
    BN254.G1Point wire4;
    BN254.G1Point prodPerm;
    BN254.G1Point split0;
    BN254.G1Point split1;
    BN254.G1Point split2;
    BN254.G1Point split3;
    BN254.G1Point split4;
    BN254.G1Point zeta;
    BN254.G1Point zetaOmega;
    BN254.ScalarField wireEval0;
    BN254.ScalarField wireEval1;
    BN254.ScalarField wireEval2;
    BN254.ScalarField wireEval3;
    BN254.ScalarField wireEval4;
    BN254.ScalarField sigmaEval0;
    BN254.ScalarField sigmaEval1;
    BN254.ScalarField sigmaEval2;
    BN254.ScalarField sigmaEval3;
    BN254.ScalarField prodPermZetaOmegaEval;
}
</code></pre>
<h3 id="verifyingkey"><a class="header" href="#verifyingkey">VerifyingKey</a></h3>
<pre><code class="language-solidity">struct VerifyingKey {
    uint256 domainSize;
    uint256 numInputs;
    BN254.G1Point sigma0;
    BN254.G1Point sigma1;
    BN254.G1Point sigma2;
    BN254.G1Point sigma3;
    BN254.G1Point sigma4;
    BN254.G1Point q1;
    BN254.G1Point q2;
    BN254.G1Point q3;
    BN254.G1Point q4;
    BN254.G1Point qM12;
    BN254.G1Point qM34;
    BN254.G1Point qO;
    BN254.G1Point qC;
    BN254.G1Point qH1;
    BN254.G1Point qH2;
    BN254.G1Point qH3;
    BN254.G1Point qH4;
    BN254.G1Point qEcc;
    bytes32 g2LSB;
    bytes32 g2MSB;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-2"><a class="header" href="#contents-2">Contents</a></h1>
<ul>
<li><a href="contracts/src/legacy/Transcript.sol/library.Transcript.html">Transcript</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="transcript"><a class="header" href="#transcript">Transcript</a></h1>
<p><a href="https://github.com/EspressoSystems/espresso-sequencer/blob/e8acf9c949a2e8444895bbc1fae887b9ef33992c/contracts/src/legacy/Transcript.sol">Git Source</a></p>
<h2 id="functions-2"><a class="header" href="#functions-2">Functions</a></h2>
<h3 id="appendmessage"><a class="header" href="#appendmessage">appendMessage</a></h3>
<pre><code class="language-solidity">function appendMessage(TranscriptData memory self, bytes memory message) internal pure;
</code></pre>
<h3 id="appendchallenge"><a class="header" href="#appendchallenge">appendChallenge</a></h3>
<pre><code class="language-solidity">function appendChallenge(TranscriptData memory self, uint256 challenge) internal pure;
</code></pre>
<h3 id="appendcommitments"><a class="header" href="#appendcommitments">appendCommitments</a></h3>
<pre><code class="language-solidity">function appendCommitments(TranscriptData memory self, BN254.G1Point[] memory comms)
    internal
    pure;
</code></pre>
<h3 id="appendcommitment"><a class="header" href="#appendcommitment">appendCommitment</a></h3>
<pre><code class="language-solidity">function appendCommitment(TranscriptData memory self, BN254.G1Point memory comm) internal pure;
</code></pre>
<h3 id="getchallenge"><a class="header" href="#getchallenge">getChallenge</a></h3>
<pre><code class="language-solidity">function getChallenge(TranscriptData memory self) internal pure returns (uint256 ret);
</code></pre>
<h3 id="appendvkandpubinput"><a class="header" href="#appendvkandpubinput">appendVkAndPubInput</a></h3>
<p><em>Append the verifying key and the public inputs to the transcript.</em></p>
<pre><code class="language-solidity">function appendVkAndPubInput(
    TranscriptData memory self,
    IPlonkVerifier.VerifyingKey memory verifyingKey,
    uint256[] memory publicInput
) internal pure;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>self</code></td><td><code>TranscriptData</code></td><td></td></tr>
<tr><td><code>verifyingKey</code></td><td><code>IPlonkVerifier.VerifyingKey</code></td><td>verifying key</td></tr>
<tr><td><code>publicInput</code></td><td><code>uint256[]</code></td><td>a list of field elements</td></tr>
</tbody></table>
</div>
<h3 id="appendproofevaluations"><a class="header" href="#appendproofevaluations">appendProofEvaluations</a></h3>
<p><em>Append the proof to the transcript. Only used for test purposes.</em></p>
<pre><code class="language-solidity">function appendProofEvaluations(TranscriptData memory self, IPlonkVerifier.PlonkProof memory proof)
    internal
    pure;
</code></pre>
<h2 id="structs-2"><a class="header" href="#structs-2">Structs</a></h2>
<h3 id="transcriptdata"><a class="header" href="#transcriptdata">TranscriptData</a></h3>
<pre><code class="language-solidity">struct TranscriptData {
    bytes32 state;
    bytes transcript;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contents-3"><a class="header" href="#contents-3">Contents</a></h1>
<ul>
<li><a href="contracts/src/libraries/BLSSig.sol/library.BLSSig.html">BLSSig</a></li>
<li><a href="contracts/src/libraries/EdOnBn254.sol/library.EdOnBN254.html">EdOnBN254</a></li>
<li><a href="contracts/src/libraries/LightClientStateUpdateVK.sol/library.LightClientStateUpdateVK.html">LightClientStateUpdateVK</a></li>
<li><a href="contracts/src/libraries/PlonkVerifier.sol/library.PlonkVerifier.html">PlonkVerifier</a></li>
<li><a href="contracts/src/libraries/PlonkVerifier2.sol/library.PlonkVerifier2.html">PlonkVerifier2</a></li>
<li><a href="contracts/src/libraries/PolynomialEval.sol/library.PolynomialEval.html">PolynomialEval</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="blssig"><a class="header" href="#blssig">BLSSig</a></h1>
<p><a href="https://github.com/EspressoSystems/espresso-sequencer/blob/e8acf9c949a2e8444895bbc1fae887b9ef33992c/contracts/src/libraries/BLSSig.sol">Git Source</a></p>
<p><em>test top
This library implements the verification of the BLS signature scheme over the BN254 curve
following
the rust implementation at
https://github.com/EspressoSystems/jellyfish/blob/e1e683c287f20160738e6e737295dd8f9e70577a/primitives/src/signatures/bls_over_bn254.rs</em></p>
<h2 id="functions-3"><a class="header" href="#functions-3">Functions</a></h2>
<h3 id="_uint256frombyteslittleendian"><a class="header" href="#_uint256frombyteslittleendian">_uint256FromBytesLittleEndian</a></h3>
<pre><code class="language-solidity">function _uint256FromBytesLittleEndian(uint8[] memory input) private pure returns (uint256);
</code></pre>
<h3 id="expand"><a class="header" href="#expand">expand</a></h3>
<p><em>Takes a sequence of bytes and turn in into another sequence of bytes with fixed size.
Equivalent of
https://github.com/arkworks-rs/algebra/blob/1f7b3c6b215e98fa3130b39d2967f6b43df41e04/ff/src/fields/field_hashers/expander/mod.rs#L37</em></p>
<pre><code class="language-solidity">function expand(bytes memory message) internal pure returns (bytes memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>message</code></td><td><code>bytes</code></td><td>message to be "expanded"</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes</code></td><td>fixed size array of bytes</td></tr>
</tbody></table>
</div>
<h3 id="hashtofield"><a class="header" href="#hashtofield">hashToField</a></h3>
<p><em>Hash a sequence of bytes to a field element in Fq. Equivalent of
https://github.com/arkworks-rs/algebra/blob/1f7b3c6b215e98fa3130b39d2967f6b43df41e04/ff/src/fields/field_hashers/mod.rs#L65</em></p>
<pre><code class="language-solidity">function hashToField(bytes memory message) internal pure returns (uint256);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>message</code></td><td><code>bytes</code></td><td>input message to be hashed</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>field element in Fq</td></tr>
</tbody></table>
</div>
<h3 id="hashtocurve"><a class="header" href="#hashtocurve">hashToCurve</a></h3>
<p><em>Hash a sequence of bytes to a group element in BN254.G_1. We use the hash-and-pray
algorithm for now.
Rust implementation can be found at
https://github.com/EspressoSystems/jellyfish/blob/e1e683c287f20160738e6e737295dd8f9e70577a/primitives/src/signatures/bls_over_bn254.rs#L318</em></p>
<pre><code class="language-solidity">function hashToCurve(bytes memory input) internal view returns (BN254.G1Point memory);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>input</code></td><td><code>bytes</code></td><td>message to be hashed</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>BN254.G1Point</code></td><td>group element in G_1</td></tr>
</tbody></table>
</div>
<h3 id="verifyblssig"><a class="header" href="#verifyblssig">verifyBlsSig</a></h3>
<p><em>Verify a bls signature. Reverts if the signature is invalid</em></p>
<pre><code class="language-solidity">function verifyBlsSig(bytes memory message, BN254.G1Point memory sig, BN254.G2Point memory pk)
    internal
    view;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>message</code></td><td><code>bytes</code></td><td>message to check the signature against</td></tr>
<tr><td><code>sig</code></td><td><code>BN254.G1Point</code></td><td>signature represented as a point in BN254.G_1</td></tr>
<tr><td><code>pk</code></td><td><code>BN254.G2Point</code></td><td>public key represented as a point in BN254.G_2</td></tr>
</tbody></table>
</div>
<h2 id="errors"><a class="header" href="#errors">Errors</a></h2>
<h3 id="blssigverificationfailed"><a class="header" href="#blssigverificationfailed">BLSSigVerificationFailed</a></h3>
<pre><code class="language-solidity">error BLSSigVerificationFailed();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="edonbn254"><a class="header" href="#edonbn254">EdOnBN254</a></h1>
<p><a href="https://github.com/EspressoSystems/espresso-sequencer/blob/e8acf9c949a2e8444895bbc1fae887b9ef33992c/contracts/src/libraries/EdOnBn254.sol">Git Source</a></p>
<p>Edward curve on BN254.
This library only implements a serialization function that is consistent with
Arkworks' format. It does not support any group operations.</p>
<h2 id="state-variables-1"><a class="header" href="#state-variables-1">State Variables</a></h2>
<h3 id="p_mod"><a class="header" href="#p_mod">P_MOD</a></h3>
<pre><code class="language-solidity">uint256 public constant P_MOD =
    21888242871839275222246405745257275088548364400416034343698204186575808495617;
</code></pre>
<h2 id="functions-4"><a class="header" href="#functions-4">Functions</a></h2>
<h3 id="isynegative"><a class="header" href="#isynegative">isYNegative</a></h3>
<p><em>Check if y-coordinate of G1 point is negative.</em></p>
<pre><code class="language-solidity">function isYNegative(EdOnBN254Point memory point) internal pure returns (bool);
</code></pre>
<h3 id="serialize"><a class="header" href="#serialize">serialize</a></h3>
<p><em>Serialize a point into bytes</em></p>
<pre><code class="language-solidity">function serialize(EdOnBN254Point memory point) internal pure returns (bytes memory res);
</code></pre>
<h2 id="structs-3"><a class="header" href="#structs-3">Structs</a></h2>
<h3 id="edonbn254point"><a class="header" href="#edonbn254point">EdOnBN254Point</a></h3>
<pre><code class="language-solidity">struct EdOnBN254Point {
    uint256 x;
    uint256 y;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="lightclientstateupdatevk"><a class="header" href="#lightclientstateupdatevk">LightClientStateUpdateVK</a></h1>
<p><a href="https://github.com/EspressoSystems/espresso-sequencer/blob/e8acf9c949a2e8444895bbc1fae887b9ef33992c/contracts/src/libraries/LightClientStateUpdateVK.sol">Git Source</a></p>
<h2 id="functions-5"><a class="header" href="#functions-5">Functions</a></h2>
<h3 id="getvk"><a class="header" href="#getvk">getVk</a></h3>
<pre><code class="language-solidity">function getVk() internal pure returns (IPlonkVerifier.VerifyingKey memory vk);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="plonkverifier"><a class="header" href="#plonkverifier">PlonkVerifier</a></h1>
<p><a href="https://github.com/EspressoSystems/espresso-sequencer/blob/e8acf9c949a2e8444895bbc1fae887b9ef33992c/contracts/src/libraries/PlonkVerifier.sol">Git Source</a></p>
<p><em>The TurboPlonk formula is:
qo * wo = pub_input + q_c +
q_mul0 * w0 * w1 + q_mul1 * w2 * w3 +
q_lc0 * w0 + q_lc1 * w1 + q_lc2 * w2 + q_lc3 * w3 +
q_hash0 * w0 + q_hash1 * w1 + q_hash2 * w2 + q_hash3 * w3 +
q_ecc * w0 * w1 * w2 * w3 * wo</em></p>
<h2 id="state-variables-2"><a class="header" href="#state-variables-2">State Variables</a></h2>
<h3 id="coset_k1"><a class="header" href="#coset_k1">COSET_K1</a></h3>
<pre><code class="language-solidity">uint256 internal constant COSET_K1 =
    0x2f8dd1f1a7583c42c4e12a44e110404c73ca6c94813f85835da4fb7bb1301d4a;
</code></pre>
<h3 id="coset_k2"><a class="header" href="#coset_k2">COSET_K2</a></h3>
<pre><code class="language-solidity">uint256 internal constant COSET_K2 =
    0x1ee678a0470a75a6eaa8fe837060498ba828a3703b311d0f77f010424afeb025;
</code></pre>
<h3 id="coset_k3"><a class="header" href="#coset_k3">COSET_K3</a></h3>
<pre><code class="language-solidity">uint256 internal constant COSET_K3 =
    0x2042a587a90c187b0a087c03e29c968b950b1db26d5c82d666905a6895790c0a;
</code></pre>
<h3 id="coset_k4"><a class="header" href="#coset_k4">COSET_K4</a></h3>
<pre><code class="language-solidity">uint256 internal constant COSET_K4 =
    0x2e2b91456103698adf57b799969dea1c8f739da5d8d40dd3eb9222db7c81e881;
</code></pre>
<h3 id="beta_h_x0"><a class="header" href="#beta_h_x0">BETA_H_X0</a></h3>
<pre><code class="language-solidity">uint256 internal constant BETA_H_X0 =
    0x260e01b251f6f1c7e7ff4e580791dee8ea51d87a358e038b4efe30fac09383c1;
</code></pre>
<h3 id="beta_h_x1"><a class="header" href="#beta_h_x1">BETA_H_X1</a></h3>
<pre><code class="language-solidity">uint256 internal constant BETA_H_X1 =
    0x0118c4d5b837bcc2bc89b5b398b5974e9f5944073b32078b7e231fec938883b0;
</code></pre>
<h3 id="beta_h_y0"><a class="header" href="#beta_h_y0">BETA_H_Y0</a></h3>
<pre><code class="language-solidity">uint256 internal constant BETA_H_Y0 =
    0x04fc6369f7110fe3d25156c1bb9a72859cf2a04641f99ba4ee413c80da6a5fe4;
</code></pre>
<h3 id="beta_h_y1"><a class="header" href="#beta_h_y1">BETA_H_Y1</a></h3>
<pre><code class="language-solidity">uint256 internal constant BETA_H_Y1 =
    0x22febda3c0c0632a56475b4214e5615e11e6dd3f96e6cea2854a87d4dacc5e55;
</code></pre>
<h3 id="num_wire_types"><a class="header" href="#num_wire_types">NUM_WIRE_TYPES</a></h3>
<p>The number of wire types of the circuit, TurboPlonk has 5.</p>
<pre><code class="language-solidity">uint256 internal constant NUM_WIRE_TYPES = 5;
</code></pre>
<h2 id="functions-6"><a class="header" href="#functions-6">Functions</a></h2>
<h3 id="verify-1"><a class="header" href="#verify-1">verify</a></h3>
<p><em>Verify a single TurboPlonk proofs.</em></p>
<pre><code class="language-solidity">function verify(
    IPlonkVerifier.VerifyingKey memory verifyingKey,
    uint256[7] memory publicInput,
    IPlonkVerifier.PlonkProof memory proof
) external view returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>verifyingKey</code></td><td><code>IPlonkVerifier.VerifyingKey</code></td><td>The Plonk verification key</td></tr>
<tr><td><code>publicInput</code></td><td><code>uint256[7]</code></td><td>The public input fields</td></tr>
<tr><td><code>proof</code></td><td><code>IPlonkVerifier.PlonkProof</code></td><td>The TurboPlonk proof</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>_ A boolean indicating successful verification, false otherwise</td></tr>
</tbody></table>
</div>
<h3 id="_validateproof"><a class="header" href="#_validateproof">_validateProof</a></h3>
<p><em>Validate all group points and scalar fields. Revert if
any are invalid.</em></p>
<pre><code class="language-solidity">function _validateProof(IPlonkVerifier.PlonkProof memory proof) internal pure;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>proof</code></td><td><code>IPlonkVerifier.PlonkProof</code></td><td>A Plonk proof</td></tr>
</tbody></table>
</div>
<h3 id="_verify"><a class="header" href="#_verify">_verify</a></h3>
<pre><code class="language-solidity">function _verify(
    IPlonkVerifier.VerifyingKey memory verifyingKey,
    uint256[7] memory publicInput,
    IPlonkVerifier.PlonkProof memory proof
) private view returns (bool);
</code></pre>
<h3 id="_computechallenges"><a class="header" href="#_computechallenges">_computeChallenges</a></h3>
<pre><code class="language-solidity">function _computeChallenges(
    IPlonkVerifier.VerifyingKey memory vk,
    uint256[7] memory pi,
    IPlonkVerifier.PlonkProof memory proof
) internal pure returns (Challenges memory res);
</code></pre>
<h3 id="_computelinpolyconstantterm"><a class="header" href="#_computelinpolyconstantterm">_computeLinPolyConstantTerm</a></h3>
<p>*Compute the constant term of the linearization polynomial.</p>
<pre><code>r_plonk = PI - L1(x) * alpha^2 - alpha * \prod_i=1..m-1 (w_i + beta * sigma_i + gamma) *
(w_m + gamma) * z(xw)
</code></pre>
<p>where m is the number of wire types.*</p>
<pre><code class="language-solidity">function _computeLinPolyConstantTerm(
    Challenges memory chal,
    IPlonkVerifier.PlonkProof memory proof,
    Poly.EvalData memory evalData
) internal pure returns (uint256 res);
</code></pre>
<h3 id="_preparepolycommitments"><a class="header" href="#_preparepolycommitments">_preparePolyCommitments</a></h3>
<pre><code class="language-solidity">function _preparePolyCommitments(
    IPlonkVerifier.VerifyingKey memory verifyingKey,
    Challenges memory chal,
    Poly.EvalData memory evalData,
    IPlonkVerifier.PlonkProof memory proof
) internal view returns (BN254.G1Point memory e1, BN254.G1Point memory f1);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>e1</code></td><td><code>BN254.G1Point</code></td><td>The [E]1 in Sec 8.4, step 11 of Plonk</td></tr>
<tr><td><code>f1</code></td><td><code>BN254.G1Point</code></td><td>The [F]1 in Sec 8.4, step 10 of Plonk</td></tr>
</tbody></table>
</div>
<h3 id="_linearizationpolycomm"><a class="header" href="#_linearizationpolycomm">_linearizationPolyComm</a></h3>
<p><em>Compute the linearization poly commitment</em></p>
<pre><code class="language-solidity">function _linearizationPolyComm(
    IPlonkVerifier.VerifyingKey memory verifyingKey,
    Challenges memory challenge,
    Poly.EvalData memory evalData,
    IPlonkVerifier.PlonkProof memory proof
) private view returns (BN254.G1Point memory d1);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>verifyingKey</code></td><td><code>IPlonkVerifier.VerifyingKey</code></td><td>The verifying key</td></tr>
<tr><td><code>challenge</code></td><td><code>Challenges</code></td><td>A set of challenges</td></tr>
<tr><td><code>evalData</code></td><td><code>Poly.EvalData</code></td><td>Polynomial evaluation data</td></tr>
<tr><td><code>proof</code></td><td><code>IPlonkVerifier.PlonkProof</code></td><td>A Plonk proof</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>d1</code></td><td><code>BN254.G1Point</code></td><td>The [D]1 in Step 9 of Plonk</td></tr>
</tbody></table>
</div>
<h2 id="errors-1"><a class="header" href="#errors-1">Errors</a></h2>
<h3 id="invalidplonkargs"><a class="header" href="#invalidplonkargs">InvalidPlonkArgs</a></h3>
<p>Plonk: invalid inputs, either mismatching lengths among input arguments
or empty input.</p>
<pre><code class="language-solidity">error InvalidPlonkArgs();
</code></pre>
<h3 id="wrongplonkvk"><a class="header" href="#wrongplonkvk">WrongPlonkVK</a></h3>
<p>Plonk: wrong verification key used.</p>
<pre><code class="language-solidity">error WrongPlonkVK();
</code></pre>
<h2 id="structs-4"><a class="header" href="#structs-4">Structs</a></h2>
<h3 id="challenges"><a class="header" href="#challenges">Challenges</a></h3>
<p><em>Plonk IOP verifier challenges.</em></p>
<pre><code class="language-solidity">struct Challenges {
    uint256 alpha;
    uint256 alpha2;
    uint256 alpha3;
    uint256 beta;
    uint256 gamma;
    uint256 zeta;
    uint256 v;
    uint256 u;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="plonkverifier2"><a class="header" href="#plonkverifier2">PlonkVerifier2</a></h1>
<p><a href="https://github.com/EspressoSystems/espresso-sequencer/blob/e8acf9c949a2e8444895bbc1fae887b9ef33992c/contracts/src/libraries/PlonkVerifier2.sol">Git Source</a></p>
<h2 id="state-variables-3"><a class="header" href="#state-variables-3">State Variables</a></h2>
<h3 id="p_mod-1"><a class="header" href="#p_mod-1">P_MOD</a></h3>
<pre><code class="language-solidity">uint256 public constant P_MOD =
    21888242871839275222246405745257275088696311157297823662689037894645226208583;
</code></pre>
<h3 id="r_mod"><a class="header" href="#r_mod">R_MOD</a></h3>
<pre><code class="language-solidity">uint256 public constant R_MOD =
    21888242871839275222246405745257275088548364400416034343698204186575808495617;
</code></pre>
<h3 id="coset_k1-1"><a class="header" href="#coset_k1-1">COSET_K1</a></h3>
<pre><code class="language-solidity">uint256 private constant COSET_K1 =
    0x2f8dd1f1a7583c42c4e12a44e110404c73ca6c94813f85835da4fb7bb1301d4a;
</code></pre>
<h3 id="coset_k2-1"><a class="header" href="#coset_k2-1">COSET_K2</a></h3>
<pre><code class="language-solidity">uint256 private constant COSET_K2 =
    0x1ee678a0470a75a6eaa8fe837060498ba828a3703b311d0f77f010424afeb025;
</code></pre>
<h3 id="coset_k3-1"><a class="header" href="#coset_k3-1">COSET_K3</a></h3>
<pre><code class="language-solidity">uint256 private constant COSET_K3 =
    0x2042a587a90c187b0a087c03e29c968b950b1db26d5c82d666905a6895790c0a;
</code></pre>
<h3 id="coset_k4-1"><a class="header" href="#coset_k4-1">COSET_K4</a></h3>
<pre><code class="language-solidity">uint256 private constant COSET_K4 =
    0x2e2b91456103698adf57b799969dea1c8f739da5d8d40dd3eb9222db7c81e881;
</code></pre>
<h3 id="beta_h_x0-1"><a class="header" href="#beta_h_x0-1">BETA_H_X0</a></h3>
<pre><code class="language-solidity">uint256 private constant BETA_H_X0 =
    0x260e01b251f6f1c7e7ff4e580791dee8ea51d87a358e038b4efe30fac09383c1;
</code></pre>
<h3 id="beta_h_x1-1"><a class="header" href="#beta_h_x1-1">BETA_H_X1</a></h3>
<pre><code class="language-solidity">uint256 private constant BETA_H_X1 =
    0x0118c4d5b837bcc2bc89b5b398b5974e9f5944073b32078b7e231fec938883b0;
</code></pre>
<h3 id="beta_h_y0-1"><a class="header" href="#beta_h_y0-1">BETA_H_Y0</a></h3>
<pre><code class="language-solidity">uint256 private constant BETA_H_Y0 =
    0x04fc6369f7110fe3d25156c1bb9a72859cf2a04641f99ba4ee413c80da6a5fe4;
</code></pre>
<h3 id="beta_h_y1-1"><a class="header" href="#beta_h_y1-1">BETA_H_Y1</a></h3>
<pre><code class="language-solidity">uint256 private constant BETA_H_Y1 =
    0x22febda3c0c0632a56475b4214e5615e11e6dd3f96e6cea2854a87d4dacc5e55;
</code></pre>
<h3 id="h_x0"><a class="header" href="#h_x0">H_X0</a></h3>
<pre><code class="language-solidity">uint256 private constant H_X0 = 0x198e9393920d483a7260bfb731fb5d25f1aa493335a9e71297e485b7aef312c2;
</code></pre>
<h3 id="h_x1"><a class="header" href="#h_x1">H_X1</a></h3>
<pre><code class="language-solidity">uint256 private constant H_X1 = 0x1800deef121f1e76426a00665e5c4479674322d4f75edadd46debd5cd992f6ed;
</code></pre>
<h3 id="h_y0"><a class="header" href="#h_y0">H_Y0</a></h3>
<pre><code class="language-solidity">uint256 private constant H_Y0 = 0x090689d0585ff075ec9e99ad690c3395bc4b313370b38ef355acdadcd122975b;
</code></pre>
<h3 id="h_y1"><a class="header" href="#h_y1">H_Y1</a></h3>
<pre><code class="language-solidity">uint256 private constant H_Y1 = 0x12c85ea5db8c6deb4aab71808dcb408fe3d1e7690c43d37b4ce6cc0166fa7daa;
</code></pre>
<h3 id="num_wire_types-1"><a class="header" href="#num_wire_types-1">NUM_WIRE_TYPES</a></h3>
<p>The number of wire types of the circuit, TurboPlonk has 5.</p>
<pre><code class="language-solidity">uint256 private constant NUM_WIRE_TYPES = 5;
</code></pre>
<h3 id="error_string_id"><a class="header" href="#error_string_id">ERROR_STRING_ID</a></h3>
<pre><code class="language-solidity">uint256 private constant ERROR_STRING_ID =
    0x08c379a000000000000000000000000000000000000000000000000000000000;
</code></pre>
<h2 id="functions-7"><a class="header" href="#functions-7">Functions</a></h2>
<h3 id="_validateproof-1"><a class="header" href="#_validateproof-1">_validateProof</a></h3>
<p><em>Validate all group points and scalar fields. Revert if
any are invalid.</em></p>
<pre><code class="language-solidity">function _validateProof(IPlonkVerifier.PlonkProof memory proof) internal pure;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>proof</code></td><td><code>IPlonkVerifier.PlonkProof</code></td><td>A Plonk proof</td></tr>
</tbody></table>
</div>
<h3 id="_computelinpolyconstantterm-1"><a class="header" href="#_computelinpolyconstantterm-1">_computeLinPolyConstantTerm</a></h3>
<p>*Compute the constant term of the linearization polynomial.</p>
<pre><code>r_plonk = PI - L1(x) * alpha^2 - alpha * \prod_i=1..m-1 (w_i + beta * sigma_i + gamma) *
(w_m + gamma) * z(xw)
</code></pre>
<p>where m is the number of wire types.*</p>
<pre><code class="language-solidity">function _computeLinPolyConstantTerm(
    Challenges memory chal,
    IPlonkVerifier.PlonkProof memory proof,
    Poly.EvalData memory evalData
) internal pure returns (uint256 res);
</code></pre>
<h3 id="_computechallenges-1"><a class="header" href="#_computechallenges-1">_computeChallenges</a></h3>
<pre><code class="language-solidity">function _computeChallenges(
    IPlonkVerifier.VerifyingKey memory vk,
    uint256[7] memory pi,
    IPlonkVerifier.PlonkProof memory proof
) internal pure returns (Challenges memory res);
</code></pre>
<h3 id="verify-2"><a class="header" href="#verify-2">verify</a></h3>
<pre><code class="language-solidity">function verify(
    IPlonkVerifier.VerifyingKey memory vk,
    uint256[7] memory publicInput,
    IPlonkVerifier.PlonkProof memory proof
) external view returns (bool success);
</code></pre>
<h2 id="structs-5"><a class="header" href="#structs-5">Structs</a></h2>
<h3 id="challenges-1"><a class="header" href="#challenges-1">Challenges</a></h3>
<p><em>Plonk IOP verifier challenges.</em></p>
<pre><code class="language-solidity">struct Challenges {
    uint256 alpha;
    uint256 alpha2;
    uint256 alpha3;
    uint256 beta;
    uint256 gamma;
    uint256 zeta;
    uint256 v;
    uint256 u;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="polynomialeval"><a class="header" href="#polynomialeval">PolynomialEval</a></h1>
<p><a href="https://github.com/EspressoSystems/espresso-sequencer/blob/e8acf9c949a2e8444895bbc1fae887b9ef33992c/contracts/src/libraries/PolynomialEval.sol">Git Source</a></p>
<h2 id="functions-8"><a class="header" href="#functions-8">Functions</a></h2>
<h3 id="newevaldomain"><a class="header" href="#newevaldomain">newEvalDomain</a></h3>
<p><em>Create a new Radix2EvalDomain with <code>domainSize</code> which should be power of 2.</em></p>
<p><em>Will revert if domainSize is not among {2^5, 2^16, 2^20}</em></p>
<p><em>The hardcoded values are generated by the rust script <code>eval-domain</code>.</em></p>
<pre><code class="language-solidity">function newEvalDomain(uint256 domainSize) internal pure returns (EvalDomain memory);
</code></pre>
<h3 id="evaluatevanishingpoly"><a class="header" href="#evaluatevanishingpoly">evaluateVanishingPoly</a></h3>
<pre><code class="language-solidity">function evaluateVanishingPoly(EvalDomain memory self, uint256 zeta)
    internal
    pure
    returns (uint256 res);
</code></pre>
<h3 id="evaluatelagrangeone"><a class="header" href="#evaluatelagrangeone">evaluateLagrangeOne</a></h3>
<p><em>Evaluate the lagrange polynomial at point <code>zeta</code> given the vanishing polynomial
evaluation <code>vanish_eval</code>.</em></p>
<pre><code class="language-solidity">function evaluateLagrangeOne(
    EvalDomain memory self,
    BN254.ScalarField zeta,
    BN254.ScalarField vanishEval
) internal view returns (BN254.ScalarField res);
</code></pre>
<h3 id="evaluatepipoly"><a class="header" href="#evaluatepipoly">evaluatePiPoly</a></h3>
<p><em>Evaluate public input polynomial at point <code>zeta</code>.</em></p>
<pre><code class="language-solidity">function evaluatePiPoly(
    EvalDomain memory self,
    uint256[7] memory pi,
    uint256 zeta,
    uint256 vanishingPolyEval
) internal view returns (uint256 res);
</code></pre>
<h3 id="evaldatagen"><a class="header" href="#evaldatagen">evalDataGen</a></h3>
<p><em>compute the EvalData for a given domain and a challenge zeta</em></p>
<pre><code class="language-solidity">function evalDataGen(EvalDomain memory self, uint256 zeta, uint256[7] memory publicInput)
    internal
    view
    returns (EvalData memory evalData);
</code></pre>
<h2 id="errors-2"><a class="header" href="#errors-2">Errors</a></h2>
<h3 id="unsupporteddegree"><a class="header" href="#unsupporteddegree">UnsupportedDegree</a></h3>
<p>Unsupported polynomial degree, currently size must in 2^{14~17}.</p>
<pre><code class="language-solidity">error UnsupportedDegree();
</code></pre>
<h2 id="structs-6"><a class="header" href="#structs-6">Structs</a></h2>
<h3 id="evaldomain"><a class="header" href="#evaldomain">EvalDomain</a></h3>
<p><em>a Radix 2 Evaluation Domain</em></p>
<pre><code class="language-solidity">struct EvalDomain {
    uint256 logSize;
    uint256 sizeInv;
    uint256[7] elements;
}
</code></pre>
<h3 id="evaldata"><a class="header" href="#evaldata">EvalData</a></h3>
<p><em>stores vanishing poly, lagrange at 1, and Public input poly</em></p>
<pre><code class="language-solidity">struct EvalData {
    BN254.ScalarField vanishEval;
    BN254.ScalarField lagrangeOne;
    BN254.ScalarField piEval;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="exampletoken"><a class="header" href="#exampletoken">ExampleToken</a></h1>
<p><a href="https://github.com/EspressoSystems/espresso-sequencer/blob/e8acf9c949a2e8444895bbc1fae887b9ef33992c/contracts/src/ExampleToken.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
ERC20</p>
<h2 id="functions-9"><a class="header" href="#functions-9">Functions</a></h2>
<h3 id="constructor"><a class="header" href="#constructor">constructor</a></h3>
<pre><code class="language-solidity">constructor(uint256 initialSupply) ERC20("Example", "EX", 18);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="feecontract"><a class="header" href="#feecontract">FeeContract</a></h1>
<p><a href="https://github.com/EspressoSystems/espresso-sequencer/blob/e8acf9c949a2e8444895bbc1fae887b9ef33992c/contracts/src/FeeContract.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
Initializable, OwnableUpgradeable, UUPSUpgradeable</p>
<h2 id="state-variables-4"><a class="header" href="#state-variables-4">State Variables</a></h2>
<h3 id="maxdepositamount"><a class="header" href="#maxdepositamount">maxDepositAmount</a></h3>
<p>max amount allowed to be deposited to prevent fat finger errors</p>
<pre><code class="language-solidity">uint256 public maxDepositAmount;
</code></pre>
<h3 id="mindepositamount"><a class="header" href="#mindepositamount">minDepositAmount</a></h3>
<pre><code class="language-solidity">uint256 public minDepositAmount;
</code></pre>
<h3 id="balances"><a class="header" href="#balances">balances</a></h3>
<p>store user balances in a mapping</p>
<pre><code class="language-solidity">mapping(address user =&gt; uint256 amount) public balances;
</code></pre>
<h2 id="functions-10"><a class="header" href="#functions-10">Functions</a></h2>
<h3 id="constructor-1"><a class="header" href="#constructor-1">constructor</a></h3>
<p>since the constructor initializes storage on this contract we disable it</p>
<p><em>storage is on the proxy contract since it calls this contract via delegatecall</em></p>
<p><strong>Note:</strong>
constructor</p>
<pre><code class="language-solidity">constructor();
</code></pre>
<h3 id="initialize"><a class="header" href="#initialize">initialize</a></h3>
<p>This contract is called by the proxy when you deploy this contract</p>
<pre><code class="language-solidity">function initialize(address multisig) public initializer;
</code></pre>
<h3 id="fallback"><a class="header" href="#fallback">fallback</a></h3>
<p>Revert if a method name does not exist</p>
<pre><code class="language-solidity">fallback() external payable;
</code></pre>
<h3 id="receive"><a class="header" href="#receive">receive</a></h3>
<p>Revert if no method name was called</p>
<pre><code class="language-solidity">receive() external payable;
</code></pre>
<h3 id="deposit-2"><a class="header" href="#deposit-2">deposit</a></h3>
<p>Allows anyone to deposit an ETH balance for any user</p>
<p><em>the deposit amount is less than a specified threshold to prevent fat finger errors</em></p>
<pre><code class="language-solidity">function deposit(address user) public payable;
</code></pre>
<h3 id="_authorizeupgrade"><a class="header" href="#_authorizeupgrade">_authorizeUpgrade</a></h3>
<p>only the owner can authorize an upgrade</p>
<pre><code class="language-solidity">function _authorizeUpgrade(address newImplementation) internal override onlyOwner;
</code></pre>
<h3 id="getversion"><a class="header" href="#getversion">getVersion</a></h3>
<p>Use this to get the implementation contract version</p>
<pre><code class="language-solidity">function getVersion()
    public
    pure
    returns (uint8 majorVersion, uint8 minorVersion, uint8 patchVersion);
</code></pre>
<h2 id="events-1"><a class="header" href="#events-1">Events</a></h2>
<h3 id="deposit-3"><a class="header" href="#deposit-3">Deposit</a></h3>
<p>Notify a new deposit</p>
<pre><code class="language-solidity">event Deposit(address indexed user, uint256 amount);
</code></pre>
<h3 id="log"><a class="header" href="#log">Log</a></h3>
<pre><code class="language-solidity">event Log(string func, uint256 gas);
</code></pre>
<h3 id="upgrade"><a class="header" href="#upgrade">Upgrade</a></h3>
<p>upgrade event when the proxy updates the implementation it's pointing to</p>
<pre><code class="language-solidity">event Upgrade(address implementation);
</code></pre>
<h2 id="errors-3"><a class="header" href="#errors-3">Errors</a></h2>
<h3 id="invaliduseraddress"><a class="header" href="#invaliduseraddress">InvalidUserAddress</a></h3>
<p>error types</p>
<pre><code class="language-solidity">error InvalidUserAddress();
</code></pre>
<h3 id="deposittoolarge"><a class="header" href="#deposittoolarge">DepositTooLarge</a></h3>
<pre><code class="language-solidity">error DepositTooLarge();
</code></pre>
<h3 id="deposittoosmall"><a class="header" href="#deposittoosmall">DepositTooSmall</a></h3>
<pre><code class="language-solidity">error DepositTooSmall();
</code></pre>
<h3 id="functiondoesnotexist"><a class="header" href="#functiondoesnotexist">FunctionDoesNotExist</a></h3>
<pre><code class="language-solidity">error FunctionDoesNotExist();
</code></pre>
<h3 id="nofunctioncalled"><a class="header" href="#nofunctioncalled">NoFunctionCalled</a></h3>
<pre><code class="language-solidity">error NoFunctionCalled();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="lightclient"><a class="header" href="#lightclient">LightClient</a></h1>
<p><a href="https://github.com/EspressoSystems/espresso-sequencer/blob/e8acf9c949a2e8444895bbc1fae887b9ef33992c/contracts/src/LightClient.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
Initializable, OwnableUpgradeable, UUPSUpgradeable</p>
<p>This contract serves as an always-on client
that verifies HotShot's state (Espresso's consensus state) which can be used by
Rollup contracts on L1 (Ethereum).
This state is submitted by any state-prover with evidence which is
a SNARK proof that proves consensus.
This contract also keeps track of the current epoch.
For this version, the epoch is not used. <br>
The light client state primarily consists of:<br></p>
<ul>
<li>the merkle root of finalized block commitments,<br></li>
<li>the fee ledger commitment and <br></li>
<li>the active stake table commitment<br></li>
</ul>
<p><em>You can use this contract to keep track of its finalized states in safe,
authenticated ways.</em></p>
<h2 id="state-variables-5"><a class="header" href="#state-variables-5">State Variables</a></h2>
<h3 id="genesisstaketablestate"><a class="header" href="#genesisstaketablestate">genesisStakeTableState</a></h3>
<p>genesis stake commitment</p>
<pre><code class="language-solidity">StakeTableState public genesisStakeTableState;
</code></pre>
<h3 id="genesisstate"><a class="header" href="#genesisstate">genesisState</a></h3>
<p>genesis block commitment</p>
<pre><code class="language-solidity">LightClientState public genesisState;
</code></pre>
<h3 id="finalizedstate"><a class="header" href="#finalizedstate">finalizedState</a></h3>
<p>Finalized HotShot's light client state</p>
<pre><code class="language-solidity">LightClientState public finalizedState;
</code></pre>
<h3 id="permissionedprover"><a class="header" href="#permissionedprover">permissionedProver</a></h3>
<p>the address of the prover that can call the newFinalizedState function when the
contract is in permissioned prover mode. This address is address(0) when the contract is
not in permissioned prover mode</p>
<pre><code class="language-solidity">address public permissionedProver;
</code></pre>
<h3 id="statehistoryretentionperiod"><a class="header" href="#statehistoryretentionperiod">stateHistoryRetentionPeriod</a></h3>
<p>Max number of seconds worth of state commitments to record based on this block
timestamp</p>
<pre><code class="language-solidity">uint32 public stateHistoryRetentionPeriod;
</code></pre>
<h3 id="statehistoryfirstindex"><a class="header" href="#statehistoryfirstindex">stateHistoryFirstIndex</a></h3>
<p>index of first block in block state series</p>
<p><em>use this instead of index 0 since old states would be set to zero to keep storage costs
constant to stateHistoryRetentionPeriod</em></p>
<pre><code class="language-solidity">uint64 public stateHistoryFirstIndex;
</code></pre>
<h3 id="statehistorycommitments"><a class="header" href="#statehistorycommitments">stateHistoryCommitments</a></h3>
<p>an array to store the L1 block heights, HotShot Block Heights and their respective
state history
commitments</p>
<pre><code class="language-solidity">StateHistoryCommitment[] public stateHistoryCommitments;
</code></pre>
<h2 id="functions-11"><a class="header" href="#functions-11">Functions</a></h2>
<h3 id="constructor-2"><a class="header" href="#constructor-2">constructor</a></h3>
<p>Constructor disables initializers to prevent the implementation contract from being
initialized</p>
<p><em>This is standard practice for OpenZeppelin upgradeable contracts. Storage is on the
proxy contract
since it calls this cnotract via delegatecall</em></p>
<p><strong>Note:</strong>
constructor</p>
<pre><code class="language-solidity">constructor();
</code></pre>
<h3 id="initialize-1"><a class="header" href="#initialize-1">initialize</a></h3>
<p>This contract is called by the proxy when you deploy this contract</p>
<pre><code class="language-solidity">function initialize(
    LightClientState memory _genesis,
    StakeTableState memory _genesisStakeTableState,
    uint32 _stateHistoryRetentionPeriod,
    address owner
) public initializer;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_genesis</code></td><td><code>LightClientState</code></td><td>The initial state of the light client</td></tr>
<tr><td><code>_genesisStakeTableState</code></td><td><code>StakeTableState</code></td><td></td></tr>
<tr><td><code>_stateHistoryRetentionPeriod</code></td><td><code>uint32</code></td><td>The maximum retention period (in seconds) for the state history. the min retention period allowed is 1 hour and max 365 days</td></tr>
<tr><td><code>owner</code></td><td><code>address</code></td><td>The address of the contract owner</td></tr>
</tbody></table>
</div>
<h3 id="getversion-1"><a class="header" href="#getversion-1">getVersion</a></h3>
<p>Use this to get the implementation contract version</p>
<pre><code class="language-solidity">function getVersion()
    public
    pure
    virtual
    returns (uint8 majorVersion, uint8 minorVersion, uint8 patchVersion);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>majorVersion</code></td><td><code>uint8</code></td><td>The major version of the contract</td></tr>
<tr><td><code>minorVersion</code></td><td><code>uint8</code></td><td>The minor version of the contract</td></tr>
<tr><td><code>patchVersion</code></td><td><code>uint8</code></td><td>The patch version of the contract</td></tr>
</tbody></table>
</div>
<h3 id="_authorizeupgrade-1"><a class="header" href="#_authorizeupgrade-1">_authorizeUpgrade</a></h3>
<p>only the owner can authorize an upgrade</p>
<pre><code class="language-solidity">function _authorizeUpgrade(address newImplementation) internal virtual override onlyOwner;
</code></pre>
<h3 id="_initializestate"><a class="header" href="#_initializestate">_initializeState</a></h3>
<p><em>Initialization of contract variables happens in this method because the LightClient
contract is upgradable and thus has its constructor method disabled.</em></p>
<pre><code class="language-solidity">function _initializeState(
    LightClientState memory _genesis,
    StakeTableState memory _genesisStakeTableState,
    uint32 _stateHistoryRetentionPeriod
) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>_genesis</code></td><td><code>LightClientState</code></td><td>The initial state of the light client</td></tr>
<tr><td><code>_genesisStakeTableState</code></td><td><code>StakeTableState</code></td><td>The initial stake table state of the light client</td></tr>
<tr><td><code>_stateHistoryRetentionPeriod</code></td><td><code>uint32</code></td><td>The maximum retention period (in seconds) for the state history. The min retention period allowed is 1 hour and the max is 365 days.</td></tr>
</tbody></table>
</div>
<h3 id="newfinalizedstate"><a class="header" href="#newfinalizedstate">newFinalizedState</a></h3>
<p>Update the latest finalized light client state. It must be updated
periodically, especially an update for the last block for every
period has to be submitted
before any newer state can be accepted since the stake table commitments of that block
become the snapshots used for vote verifications later on.</p>
<p>While <code>newState.stakeTable*</code> refers to the (possibly) new stake table states,
the entire <code>newState</code> needs to be signed by stakers in <code>finalizedState</code></p>
<p><em>if the permissionedProver is set, only the permissionedProver can call this function</em></p>
<p><em>the state history for <code>stateHistoryRetentionPeriod</code> L1 blocks are also recorded in the
<code>stateHistoryCommitments</code> array</em></p>
<pre><code class="language-solidity">function newFinalizedState(LightClientState memory newState, IPlonkVerifier.PlonkProof memory proof)
    external
    virtual;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>newState</code></td><td><code>LightClientState</code></td><td>new light client state</td></tr>
<tr><td><code>proof</code></td><td><code>IPlonkVerifier.PlonkProof</code></td><td>PlonkProof</td></tr>
</tbody></table>
</div>
<h3 id="verifyproof"><a class="header" href="#verifyproof">verifyProof</a></h3>
<p>Verify the Plonk proof, marked as <code>virtual</code> for easier testing as we can swap VK
used in inherited contracts.</p>
<pre><code class="language-solidity">function verifyProof(LightClientState memory state, IPlonkVerifier.PlonkProof memory proof)
    internal
    virtual;
</code></pre>
<h3 id="setpermissionedprover"><a class="header" href="#setpermissionedprover">setPermissionedProver</a></h3>
<p>set the permissionedProver to the non-zero address provided</p>
<p><em>this function can also be used to update the permissioned prover once it's a different
address to the current permissioned prover</em></p>
<pre><code class="language-solidity">function setPermissionedProver(address prover) public virtual onlyOwner;
</code></pre>
<h3 id="disablepermissionedprovermode"><a class="header" href="#disablepermissionedprovermode">disablePermissionedProverMode</a></h3>
<p>set the permissionedProver to address(0)</p>
<p><em>if it was already disabled, then revert with the error, NoChangeRequired</em></p>
<pre><code class="language-solidity">function disablePermissionedProverMode() public virtual onlyOwner;
</code></pre>
<h3 id="updatestatehistory"><a class="header" href="#updatestatehistory">updateStateHistory</a></h3>
<p>Updates the <code>stateHistoryCommitments</code> array when a new finalized state is added
and ensures that the array does not retain states older than the
<code>stateHistoryRetentionPeriod</code>.</p>
<p><em>the block timestamp is used to determine if the stateHistoryCommitments array
should be pruned, based on the stateHistoryRetentionPeriod (seconds).</em></p>
<p><em>a FIFO approach is used to delete elements from the start of the array,
ensuring that only the most recent states that only recent states are kept within
the retention window.</em></p>
<p><em>the <code>delete</code> method does not reduce the array length but resets the value at the
specified index to zero. the stateHistoryFirstIndex variable acts as an offset to indicate
the starting point for reading the array, since the length of the array is not reduced
even after deletion.</em></p>
<pre><code class="language-solidity">function updateStateHistory(
    uint64 blockNumber,
    uint64 blockTimestamp,
    LightClientState memory state
) internal;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>blockNumber</code></td><td><code>uint64</code></td><td>The block number of the new finalized state.</td></tr>
<tr><td><code>blockTimestamp</code></td><td><code>uint64</code></td><td>The block timestamp used to check the retention period.</td></tr>
<tr><td><code>state</code></td><td><code>LightClientState</code></td><td>The new <code>LightClientState</code> being added to the array.</td></tr>
</tbody></table>
</div>
<h3 id="lagoverescapehatchthreshold"><a class="header" href="#lagoverescapehatchthreshold">lagOverEscapeHatchThreshold</a></h3>
<p>checks if the state updates lag behind the specified block threshold based on the
provided block number.</p>
<p><em>Reverts if there isn't enough state history to make an accurate comparison.
Reverts if the blockThreshold is zero</em></p>
<pre><code class="language-solidity">function lagOverEscapeHatchThreshold(uint256 blockNumber, uint256 blockThreshold)
    public
    view
    virtual
    returns (bool);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>blockNumber</code></td><td><code>uint256</code></td><td>The block number to compare against the latest state updates.</td></tr>
<tr><td><code>blockThreshold</code></td><td><code>uint256</code></td><td>The number of blocks updates this contract is allowed to lag behind.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bool</code></td><td>bool returns true if the lag exceeds the blockThreshold; otherwise, false.</td></tr>
</tbody></table>
</div>
<h3 id="gethotshotcommitment"><a class="header" href="#gethotshotcommitment">getHotShotCommitment</a></h3>
<p>get the HotShot commitment that represents the Merkle root containing the leaf at
the provided hotShotBlockHeight where the block height in the array is greater than</p>
<p><em>if the provided hotShotBlockHeight is greater than the latest commitment in the array,
the function reverts.</em></p>
<pre><code class="language-solidity">function getHotShotCommitment(uint256 hotShotBlockHeight)
    public
    view
    virtual
    returns (BN254.ScalarField hotShotBlockCommRoot, uint64 hotshotBlockHeight);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>hotShotBlockHeight</code></td><td><code>uint256</code></td><td>the HotShot block height</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>hotShotBlockCommRoot</code></td><td><code>BN254.ScalarField</code></td><td>the HotShot commitment root</td></tr>
<tr><td><code>hotshotBlockHeight</code></td><td><code>uint64</code></td><td>the HotShot block height for the corresponding commitment root</td></tr>
</tbody></table>
</div>
<h3 id="getstatehistorycount"><a class="header" href="#getstatehistorycount">getStateHistoryCount</a></h3>
<p>get the number of state history commitments</p>
<pre><code class="language-solidity">function getStateHistoryCount() public view returns (uint256);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>uint256 The number of state history commitments</td></tr>
</tbody></table>
</div>
<h3 id="setstatehistoryretentionperiod"><a class="header" href="#setstatehistoryretentionperiod">setstateHistoryRetentionPeriod</a></h3>
<p>sets the maximum retention period for storing block state history.</p>
<p><em>Reverts with <code>InvalidMaxStateHistory</code> if the provided value is less than 1 hour,
more than 365 days or less than or equal to the current state history retention period.</em></p>
<pre><code class="language-solidity">function setstateHistoryRetentionPeriod(uint32 historySeconds) public onlyOwner;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>historySeconds</code></td><td><code>uint32</code></td><td>The maximum number of seconds for which state history updates will be stored, based on the block timestamp. It must be greater than or equal to the current state history retention period and must be at least 1 hour and max 365 days.</td></tr>
</tbody></table>
</div>
<h3 id="ispermissionedproverenabled"><a class="header" href="#ispermissionedproverenabled">isPermissionedProverEnabled</a></h3>
<p>Check if permissioned prover is enabled</p>
<pre><code class="language-solidity">function isPermissionedProverEnabled() public view returns (bool);
</code></pre>
<h2 id="events-2"><a class="header" href="#events-2">Events</a></h2>
<h3 id="upgrade-1"><a class="header" href="#upgrade-1">Upgrade</a></h3>
<p>upgrade event when the proxy updates the implementation it's pointing to</p>
<pre><code class="language-solidity">event Upgrade(address implementation);
</code></pre>
<h3 id="permissionedproverrequired"><a class="header" href="#permissionedproverrequired">PermissionedProverRequired</a></h3>
<p>when a permissioned prover is set, this event is emitted.</p>
<pre><code class="language-solidity">event PermissionedProverRequired(address permissionedProver);
</code></pre>
<h3 id="permissionedprovernotrequired"><a class="header" href="#permissionedprovernotrequired">PermissionedProverNotRequired</a></h3>
<p>when the permissioned prover is unset, this event is emitted.</p>
<pre><code class="language-solidity">event PermissionedProverNotRequired();
</code></pre>
<h3 id="newstate"><a class="header" href="#newstate">NewState</a></h3>
<p>Event that a new finalized state has been successfully verified and updated</p>
<pre><code class="language-solidity">event NewState(uint64 indexed viewNum, uint64 indexed blockHeight, BN254.ScalarField blockCommRoot);
</code></pre>
<h2 id="errors-4"><a class="header" href="#errors-4">Errors</a></h2>
<h3 id="outdatedstate"><a class="header" href="#outdatedstate">OutdatedState</a></h3>
<p>The state is outdated and older than currently known <code>finalizedState</code></p>
<pre><code class="language-solidity">error OutdatedState();
</code></pre>
<h3 id="invalidargs"><a class="header" href="#invalidargs">InvalidArgs</a></h3>
<p>Invalid user inputs: wrong format or non-sensible arguments</p>
<pre><code class="language-solidity">error InvalidArgs();
</code></pre>
<h3 id="invalidproof"><a class="header" href="#invalidproof">InvalidProof</a></h3>
<p>Wrong plonk proof or public inputs.</p>
<pre><code class="language-solidity">error InvalidProof();
</code></pre>
<h3 id="wrongstaketableused"><a class="header" href="#wrongstaketableused">WrongStakeTableUsed</a></h3>
<p>Wrong stake table used, should match <code>finalizedState</code></p>
<pre><code class="language-solidity">error WrongStakeTableUsed();
</code></pre>
<h3 id="invalidaddress"><a class="header" href="#invalidaddress">InvalidAddress</a></h3>
<p>Invalid address</p>
<pre><code class="language-solidity">error InvalidAddress();
</code></pre>
<h3 id="provernotpermissioned"><a class="header" href="#provernotpermissioned">ProverNotPermissioned</a></h3>
<p>Only a permissioned prover can perform this action</p>
<pre><code class="language-solidity">error ProverNotPermissioned();
</code></pre>
<h3 id="nochangerequired"><a class="header" href="#nochangerequired">NoChangeRequired</a></h3>
<p>If the same mode or prover is sent to the function, then no change is required</p>
<pre><code class="language-solidity">error NoChangeRequired();
</code></pre>
<h3 id="insufficientsnapshothistory"><a class="header" href="#insufficientsnapshothistory">InsufficientSnapshotHistory</a></h3>
<p>Invalid L1 Block for checking Light Client Updates, premature or in the future</p>
<pre><code class="language-solidity">error InsufficientSnapshotHistory();
</code></pre>
<h3 id="invalidhotshotblockforcommitmentcheck"><a class="header" href="#invalidhotshotblockforcommitmentcheck">InvalidHotShotBlockForCommitmentCheck</a></h3>
<p>Invalid HotShot Block for checking HotShot commitments, premature or in the future</p>
<pre><code class="language-solidity">error InvalidHotShotBlockForCommitmentCheck();
</code></pre>
<h3 id="invalidmaxstatehistory"><a class="header" href="#invalidmaxstatehistory">InvalidMaxStateHistory</a></h3>
<p>Invalid Max Block States</p>
<pre><code class="language-solidity">error InvalidMaxStateHistory();
</code></pre>
<h2 id="structs-7"><a class="header" href="#structs-7">Structs</a></h2>
<h3 id="lightclientstate"><a class="header" href="#lightclientstate">LightClientState</a></h3>
<p>The finalized HotShot state (as the digest of the entire HotShot state)</p>
<pre><code class="language-solidity">struct LightClientState {
    uint64 viewNum;
    uint64 blockHeight;
    BN254.ScalarField blockCommRoot;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>viewNum</code></td><td><code>uint64</code></td><td>The latest view number of the finalized HotShot chain</td></tr>
<tr><td><code>blockHeight</code></td><td><code>uint64</code></td><td>The block height of the latest finalized block</td></tr>
<tr><td><code>blockCommRoot</code></td><td><code>BN254.ScalarField</code></td><td>The merkle root of historical block commitments (BN254::ScalarField)</td></tr>
</tbody></table>
</div>
<h3 id="staketablestate"><a class="header" href="#staketablestate">StakeTableState</a></h3>
<p>The finalized HotShot Stake state (as the digest of the entire HotShot state)</p>
<pre><code class="language-solidity">struct StakeTableState {
    uint256 threshold;
    BN254.ScalarField blsKeyComm;
    BN254.ScalarField schnorrKeyComm;
    BN254.ScalarField amountComm;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>threshold</code></td><td><code>uint256</code></td><td>The (stake-weighted) quorum threshold for a QC to be considered as valid</td></tr>
<tr><td><code>blsKeyComm</code></td><td><code>BN254.ScalarField</code></td><td>The commitment to the BlsVerKey column of the stake table</td></tr>
<tr><td><code>schnorrKeyComm</code></td><td><code>BN254.ScalarField</code></td><td>The commitment to the SchnorrVerKey column of the table</td></tr>
<tr><td><code>amountComm</code></td><td><code>BN254.ScalarField</code></td><td>The commitment to the stake amount column of the stake table</td></tr>
</tbody></table>
</div>
<h3 id="statehistorycommitment"><a class="header" href="#statehistorycommitment">StateHistoryCommitment</a></h3>
<p>Simplified HotShot commitment struct</p>
<pre><code class="language-solidity">struct StateHistoryCommitment {
    uint64 l1BlockHeight;
    uint64 l1BlockTimestamp;
    uint64 hotShotBlockHeight;
    BN254.ScalarField hotShotBlockCommRoot;
}
</code></pre>
<p><strong>Properties</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>l1BlockHeight</code></td><td><code>uint64</code></td><td>the block height of l1 when this state update was stored</td></tr>
<tr><td><code>l1BlockTimestamp</code></td><td><code>uint64</code></td><td>the block timestamp of l1 when this state update was stored</td></tr>
<tr><td><code>hotShotBlockHeight</code></td><td><code>uint64</code></td><td>The block height of the latest finalized HotShot block</td></tr>
<tr><td><code>hotShotBlockCommRoot</code></td><td><code>BN254.ScalarField</code></td><td>The merkle root of historical block commitments (BN254::ScalarField)</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="staketable"><a class="header" href="#staketable">StakeTable</a></h1>
<p><a href="https://github.com/EspressoSystems/espresso-sequencer/blob/e8acf9c949a2e8444895bbc1fae887b9ef33992c/contracts/src/StakeTable.sol">Git Source</a></p>
<p><strong>Inherits:</strong>
<a href="contracts/src/StakeTable.sol//contracts/src/interfaces/AbstractStakeTable.sol/abstract.AbstractStakeTable.html">AbstractStakeTable</a></p>
<h2 id="state-variables-6"><a class="header" href="#state-variables-6">State Variables</a></h2>
<h3 id="nodes"><a class="header" href="#nodes">nodes</a></h3>
<p>Mapping from a hash of a BLS key to a node struct defined in the abstract contract.</p>
<pre><code class="language-solidity">mapping(bytes32 keyHash =&gt; Node node) public nodes;
</code></pre>
<h3 id="totalnativestake"><a class="header" href="#totalnativestake">totalNativeStake</a></h3>
<p>Total native stake locked for the latest stake table (HEAD).</p>
<pre><code class="language-solidity">uint256 public totalNativeStake;
</code></pre>
<h3 id="totalrestakedstake"><a class="header" href="#totalrestakedstake">totalRestakedStake</a></h3>
<p>Total restaked stake locked for the latest stake table (HEAD).</p>
<pre><code class="language-solidity">uint256 public totalRestakedStake;
</code></pre>
<h3 id="tokenaddress"><a class="header" href="#tokenaddress">tokenAddress</a></h3>
<p>Address of the native token contract.</p>
<pre><code class="language-solidity">address public tokenAddress;
</code></pre>
<h3 id="lightclient-1"><a class="header" href="#lightclient-1">lightClient</a></h3>
<p>Reference to the light client contract.</p>
<pre><code class="language-solidity">LightClient public lightClient;
</code></pre>
<h3 id="firstavailableregistrationepoch"><a class="header" href="#firstavailableregistrationepoch">firstAvailableRegistrationEpoch</a></h3>
<p>the first available epoch for registration, please use <code>nextRegistrationEpoch()</code> to
get the correct epoch</p>
<pre><code class="language-solidity">uint64 public firstAvailableRegistrationEpoch;
</code></pre>
<h3 id="_numpendingregistrations"><a class="header" href="#_numpendingregistrations">_numPendingRegistrations</a></h3>
<p>number of pending registrations in the <code>firstAvailableRegistrationEpoch</code> (not the
total pending queue size!)</p>
<pre><code class="language-solidity">uint64 private _numPendingRegistrations;
</code></pre>
<h3 id="firstavailableexitepoch"><a class="header" href="#firstavailableexitepoch">firstAvailableExitEpoch</a></h3>
<p>the first available epoch for exit, please use <code>nextExitEpoch()</code> to get the correct
epoch</p>
<pre><code class="language-solidity">uint64 public firstAvailableExitEpoch;
</code></pre>
<h3 id="_numpendingexits"><a class="header" href="#_numpendingexits">_numPendingExits</a></h3>
<p>number of pending exits in the <code>firstAvailableExitEpoch</code> (not the total pending
queue size!)</p>
<pre><code class="language-solidity">uint64 private _numPendingExits;
</code></pre>
<h3 id="maxchurnrate"><a class="header" href="#maxchurnrate">maxChurnRate</a></h3>
<pre><code class="language-solidity">uint64 public maxChurnRate;
</code></pre>
<h2 id="functions-12"><a class="header" href="#functions-12">Functions</a></h2>
<h3 id="constructor-3"><a class="header" href="#constructor-3">constructor</a></h3>
<pre><code class="language-solidity">constructor(address _tokenAddress, address _lightClientAddress, uint64 churnRate);
</code></pre>
<h3 id="_hashblskey"><a class="header" href="#_hashblskey">_hashBlsKey</a></h3>
<p><em>Computes a hash value of some G2 point.</em></p>
<pre><code class="language-solidity">function _hashBlsKey(BN254.G2Point memory blsVK) public pure returns (bytes32);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>blsVK</code></td><td><code>BN254.G2Point</code></td><td>BLS verification key in G2</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>bytes32</code></td><td>keccak256(blsVK)</td></tr>
</tbody></table>
</div>
<h3 id="currentepoch"><a class="header" href="#currentepoch">currentEpoch</a></h3>
<p>TODO handle this logic more appropriately when epochs are re-introduced</p>
<p><em>Fetches the current epoch from the light client contract.</em></p>
<pre><code class="language-solidity">function currentEpoch() public pure returns (uint64);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint64</code></td><td>current epoch (computed from the current block)</td></tr>
</tbody></table>
</div>
<h3 id="totalstake-1"><a class="header" href="#totalstake-1">totalStake</a></h3>
<p>Total stakes of the registered keys in the latest stake table (Head).</p>
<p><em>Given that the current implementation does not support restaking, the second value of
the output is set to 0.</em></p>
<pre><code class="language-solidity">function totalStake() external view override returns (uint256, uint256);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td>The total stake for native token and restaked token respectively.</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint256</code></td><td></td></tr>
</tbody></table>
</div>
<h3 id="lookupstake-1"><a class="header" href="#lookupstake-1">lookupStake</a></h3>
<p>Look up the balance of <code>blsVK</code></p>
<pre><code class="language-solidity">function lookupStake(BN254.G2Point memory blsVK) external view override returns (uint64);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>blsVK</code></td><td><code>BN254.G2Point</code></td><td>BLS public key controlled by the user.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint64</code></td><td>Current balance owned by the user.</td></tr>
</tbody></table>
</div>
<h3 id="lookupnode-1"><a class="header" href="#lookupnode-1">lookupNode</a></h3>
<p>Look up the full <code>Node</code> state associated with <code>blsVK</code></p>
<p><em>The lookup is achieved by hashing first the four field elements of blsVK using
keccak256.</em></p>
<pre><code class="language-solidity">function lookupNode(BN254.G2Point memory blsVK) external view override returns (Node memory);
</code></pre>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>Node</code></td><td>Node indexed by blsVK</td></tr>
</tbody></table>
</div>
<h3 id="nextregistrationepoch-1"><a class="header" href="#nextregistrationepoch-1">nextRegistrationEpoch</a></h3>
<p>Get the next available epoch and queue size in that epoch</p>
<pre><code class="language-solidity">function nextRegistrationEpoch() external view override returns (uint64, uint64);
</code></pre>
<h3 id="appendregistrationqueue"><a class="header" href="#appendregistrationqueue">appendRegistrationQueue</a></h3>
<pre><code class="language-solidity">function appendRegistrationQueue(uint64 epoch, uint64 queueSize) private;
</code></pre>
<h3 id="numpendingregistrations-1"><a class="header" href="#numpendingregistrations-1">numPendingRegistrations</a></h3>
<p>Get the number of pending registration requests in the waiting queue</p>
<pre><code class="language-solidity">function numPendingRegistrations() external view override returns (uint64);
</code></pre>
<h3 id="nextexitepoch-1"><a class="header" href="#nextexitepoch-1">nextExitEpoch</a></h3>
<p>Get the next available epoch for exit and queue size in that epoch</p>
<pre><code class="language-solidity">function nextExitEpoch() external view override returns (uint64, uint64);
</code></pre>
<h3 id="appendexitqueue"><a class="header" href="#appendexitqueue">appendExitQueue</a></h3>
<pre><code class="language-solidity">function appendExitQueue(uint64 epoch, uint64 queueSize) private;
</code></pre>
<h3 id="numpendingexits-1"><a class="header" href="#numpendingexits-1">numPendingExits</a></h3>
<p>Get the number of pending exit requests in the waiting queue</p>
<pre><code class="language-solidity">function numPendingExits() external view override returns (uint64);
</code></pre>
<h3 id="exitescrowperiod"><a class="header" href="#exitescrowperiod">exitEscrowPeriod</a></h3>
<p>Defines the exit escrow period for a node.
TODO discuss Alex, Jeb. How much do we want to specify this function? Also marked as public
for easier testing.</p>
<p><em>To put this function into context let us consider the following workflow: requestExit
--&gt; (queueing) --&gt; Exited --&gt; (escrow) --&gt; Witdrawable. The first phase is about waiting in
queue due to rate-limiting on exit, the wait is dependent on the exit amount and currently
exit traffic. At the point of "Exited", the node is officially off duty, and stops
participating in consensus.
The second phase is about slashable security, the wait is dependent only on amount, during
which period cryptographic evidence of misbehavior (e.g. double-voting) might still lead to
the forfeit of stakes. From the point of <code>Withdrawable</code> onwards, the staker can freely
withdraw.</em></p>
<pre><code class="language-solidity">function exitEscrowPeriod(Node memory node) public pure returns (uint64);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>node</code></td><td><code>Node</code></td><td>node which is assigned an exit escrow period.</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint64</code></td><td>Number of epochs post exit after which funds can be withdrawn.</td></tr>
</tbody></table>
</div>
<h3 id="register-1"><a class="header" href="#register-1">register</a></h3>
<p>Register a validator in the stake table, transfer of tokens incurred!</p>
<p><em>No validity check on <code>schnorrVK</code>, as it's assumed to be sender's responsibility,
the contract only treat it as auxiliary info submitted by <code>blsVK</code>.</em></p>
<p><em><code>blsSig</code> field is necessary to prevent "rogue public-key attack".
The signature is over the caller address of the function to ensure that each message is
unique.</em></p>
<pre><code class="language-solidity">function register(
    BN254.G2Point memory blsVK,
    EdOnBN254.EdOnBN254Point memory schnorrVK,
    uint64 amount,
    StakeType stakeType,
    BN254.G1Point memory blsSig,
    uint64 validUntilEpoch
) external override;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>blsVK</code></td><td><code>BN254.G2Point</code></td><td>The BLS verification key</td></tr>
<tr><td><code>schnorrVK</code></td><td><code>EdOnBN254.EdOnBN254Point</code></td><td>The Schnorr verification key (as the auxiliary info)</td></tr>
<tr><td><code>amount</code></td><td><code>uint64</code></td><td>The amount to register</td></tr>
<tr><td><code>stakeType</code></td><td><code>StakeType</code></td><td>The type of staking (native or restaking)</td></tr>
<tr><td><code>blsSig</code></td><td><code>BN254.G1Point</code></td><td>The BLS signature that authenticates the ethereum account this function is called from</td></tr>
<tr><td><code>validUntilEpoch</code></td><td><code>uint64</code></td><td>The maximum epoch the sender is willing to wait to be included (cannot be smaller than the current epoch)</td></tr>
</tbody></table>
</div>
<h3 id="deposit-4"><a class="header" href="#deposit-4">deposit</a></h3>
<p>Deposit more stakes to registered keys</p>
<p><em>TODO this implementation will be revisited later. See
https://github.com/EspressoSystems/espresso-sequencer/issues/806</em></p>
<pre><code class="language-solidity">function deposit(BN254.G2Point memory blsVK, uint64 amount)
    external
    override
    returns (uint64, uint64);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>blsVK</code></td><td><code>BN254.G2Point</code></td><td>The BLS verification key</td></tr>
<tr><td><code>amount</code></td><td><code>uint64</code></td><td>The amount to deposit</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint64</code></td><td>(newBalance, effectiveEpoch) the new balance effective at a future epoch</td></tr>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint64</code></td><td></td></tr>
</tbody></table>
</div>
<h3 id="requestexit-1"><a class="header" href="#requestexit-1">requestExit</a></h3>
<p>Request to exit from the stake table, not immediately withdrawable!</p>
<pre><code class="language-solidity">function requestExit(BN254.G2Point memory blsVK) external override;
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>blsVK</code></td><td><code>BN254.G2Point</code></td><td>The BLS verification key to exit</td></tr>
</tbody></table>
</div>
<h3 id="withdrawfunds-1"><a class="header" href="#withdrawfunds-1">withdrawFunds</a></h3>
<p>Withdraw from the staking pool. Transfers occur! Only successfully exited keys can
withdraw past their <code>exitEpoch</code>.</p>
<pre><code class="language-solidity">function withdrawFunds(BN254.G2Point memory blsVK) external override returns (uint64);
</code></pre>
<p><strong>Parameters</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>blsVK</code></td><td><code>BN254.G2Point</code></td><td>The BLS verification key to withdraw</td></tr>
</tbody></table>
</div>
<p><strong>Returns</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><code>&lt;none&gt;</code></td><td><code>uint64</code></td><td>The total amount withdrawn, equal to <code>Node.balance</code> associated with <code>blsVK</code></td></tr>
</tbody></table>
</div>
<h2 id="errors-5"><a class="header" href="#errors-5">Errors</a></h2>
<h3 id="restakingnotimplemented"><a class="header" href="#restakingnotimplemented">RestakingNotImplemented</a></h3>
<p>Error to notify restaking is not implemented yet.</p>
<pre><code class="language-solidity">error RestakingNotImplemented();
</code></pre>
<h3 id="invalidnextregistrationepoch"><a class="header" href="#invalidnextregistrationepoch">InvalidNextRegistrationEpoch</a></h3>
<p>Error raised when the registration is aborted because it happens after the user specified
deadline. The first field is the next registration epoch and the second is the last epoch
the user is willing to wait for the registration to happen.</p>
<pre><code class="language-solidity">error InvalidNextRegistrationEpoch(uint64, uint64);
</code></pre>
<h3 id="nodealreadyregistered"><a class="header" href="#nodealreadyregistered">NodeAlreadyRegistered</a></h3>
<p>Error raised when a user tries to register another set of keys from the same ethereum
account.</p>
<pre><code class="language-solidity">error NodeAlreadyRegistered();
</code></pre>
<h3 id="unauthenticated"><a class="header" href="#unauthenticated">Unauthenticated</a></h3>
<p>Error raised when a user tries to make a deposit or request an exit but does not control the
node public key.</p>
<pre><code class="language-solidity">error Unauthenticated();
</code></pre>
<h3 id="prematuredeposit"><a class="header" href="#prematuredeposit">PrematureDeposit</a></h3>
<p>Error raised when a user tries to deposit before the registration is complete.</p>
<pre><code class="language-solidity">error PrematureDeposit();
</code></pre>
<h3 id="prematureexit"><a class="header" href="#prematureexit">PrematureExit</a></h3>
<p>Error raised when a user tries to exit before the registration is complete.</p>
<pre><code class="language-solidity">error PrematureExit();
</code></pre>
<h3 id="exitrequestinprogress"><a class="header" href="#exitrequestinprogress">ExitRequestInProgress</a></h3>
<p>Error raised when a user tries to deposit while an exit request is in progress.</p>
<pre><code class="language-solidity">error ExitRequestInProgress();
</code></pre>
<h3 id="prematurewithdrawal"><a class="header" href="#prematurewithdrawal">PrematureWithdrawal</a></h3>
<pre><code class="language-solidity">error PrematureWithdrawal();
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="solidity.min.js"></script>

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
