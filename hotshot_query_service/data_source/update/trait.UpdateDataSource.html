<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="An extension trait for types which implement the update trait for each API module."><title>UpdateDataSource in hotshot_query_service::data_source::update - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../../static.files/rustdoc-42caa33d.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="hotshot_query_service" data-themes="" data-resource-suffix="" data-rustdoc-version="1.84.1 (e71f9a9a9 2025-01-27)" data-channel="1.84.1" data-search-js="search-92e6798f.js" data-settings-js="settings-0f613d39.js" ><script src="../../../static.files/storage-59e33391.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../../static.files/main-5f194d8c.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-893ab5e7.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-6580c154.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-044be391.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../hotshot_query_service/index.html">hotshot_<wbr>query_<wbr>service</a><span class="version">0.1.76</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Update<wbr>Data<wbr>Source</a></h2><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.update" title="update">update</a></li></ul><h3><a href="#dyn-compatibility">Dyn Compatibility</a></h3><h3><a href="#implementors">Implementors</a></h3></section><div id="rustdoc-modnav"><h2><a href="index.html">In hotshot_<wbr>query_<wbr>service::<wbr>data_<wbr>source::<wbr>update</a></h2></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><span class="rustdoc-breadcrumbs"><a href="../../index.html">hotshot_query_service</a>::<wbr><a href="../index.html">data_source</a>::<wbr><a href="index.html">update</a></span><h1>Trait <span class="trait">UpdateDataSource</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../../src/hotshot_query_service/data_source/update.rs.html#68-87">Source</a> </span></div><pre class="rust item-decl"><code>pub trait UpdateDataSource&lt;Types: <a class="trait" href="../../../hotshot_types/traits/node_implementation/trait.NodeType.html" title="trait hotshot_types::traits::node_implementation::NodeType">NodeType</a>&gt;: <a class="trait" href="../../availability/data_source/trait.UpdateAvailabilityData.html" title="trait hotshot_query_service::availability::data_source::UpdateAvailabilityData">UpdateAvailabilityData</a>&lt;Types&gt; {
    // Required method
    fn <a href="#tymethod.update" class="fn">update</a>&lt;'life0, 'life1, 'async_trait&gt;(
        &amp;'life0 self,
        event: &amp;'life1 <a class="struct" href="../../../hotshot_types/event/struct.Event.html" title="struct hotshot_types::event::Event">Event</a>&lt;Types&gt;,
    ) -&gt; <a class="struct" href="https://doc.rust-lang.org/1.84.1/core/pin/struct.Pin.html" title="struct core::pin::Pin">Pin</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.84.1/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="https://doc.rust-lang.org/1.84.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.84.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.84.1/std/primitive.unit.html">()</a>, <a class="primitive" href="https://doc.rust-lang.org/1.84.1/std/primitive.u64.html">u64</a>&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.84.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + 'async_trait&gt;&gt;
       <span class="where">where Self: 'async_trait,
             'life0: 'async_trait,
             'life1: 'async_trait</span>;
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>An extension trait for types which implement the update trait for each API module.</p>
<p>If a type implements <a href="../../availability/data_source/trait.UpdateAvailabilityData.html" title="trait hotshot_query_service::availability::data_source::UpdateAvailabilityData">UpdateAvailabilityData</a> and
<a href="../../status/data_source/trait.UpdateStatusData.html" title="trait hotshot_query_service::status::data_source::UpdateStatusData">UpdateStatusData</a>, then it can be fully kept up to date
through two interfaces:</p>
<ul>
<li><a href="../../status/data_source/trait.UpdateStatusData.html#tymethod.populate_metrics" title="method hotshot_query_service::status::data_source::UpdateStatusData::populate_metrics">populate_metrics</a>, to get a handle for
populating the status metrics, which should be used when initializing a
<a href="../../../hotshot/types/handle/struct.SystemContextHandle.html" title="struct hotshot::types::handle::SystemContextHandle">SystemContextHandle</a></li>
<li><a href="trait.UpdateDataSource.html#tymethod.update">update</a>, provided by this extension trait, to update the query state when a new
HotShot event is emitted</li>
</ul>
</div></details><h2 id="required-methods" class="section-header">Required Methods<a href="#required-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="tymethod.update" class="method"><a class="src rightside" href="../../../src/hotshot_query_service/data_source/update.rs.html#86">Source</a><h4 class="code-header">fn <a href="#tymethod.update" class="fn">update</a>&lt;'life0, 'life1, 'async_trait&gt;(
    &amp;'life0 self,
    event: &amp;'life1 <a class="struct" href="../../../hotshot_types/event/struct.Event.html" title="struct hotshot_types::event::Event">Event</a>&lt;Types&gt;,
) -&gt; <a class="struct" href="https://doc.rust-lang.org/1.84.1/core/pin/struct.Pin.html" title="struct core::pin::Pin">Pin</a>&lt;<a class="struct" href="https://doc.rust-lang.org/1.84.1/alloc/boxed/struct.Box.html" title="struct alloc::boxed::Box">Box</a>&lt;dyn <a class="trait" href="https://doc.rust-lang.org/1.84.1/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="enum" href="https://doc.rust-lang.org/1.84.1/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.84.1/std/primitive.unit.html">()</a>, <a class="primitive" href="https://doc.rust-lang.org/1.84.1/std/primitive.u64.html">u64</a>&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/1.84.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + 'async_trait&gt;&gt;<div class="where">where
    Self: 'async_trait,
    'life0: 'async_trait,
    'life1: 'async_trait,</div></h4></section></summary><div class="docblock"><p>Update query state based on a new consensus event.</p>
<p>The caller is responsible for authenticating <code>event</code>. This function does not perform any
authentication, and if given an invalid <code>event</code> (one which does not follow from the latest
known state of the ledger) it may panic or silently accept the invalid <code>event</code>. This allows
the best possible performance in the case where the query service and the HotShot instance
are running in the same process (and thus the event stream, directly from HotShot) is
trusted.</p>
<p>If you want to update the data source with an untrusted event, for example one received from
a peer over the network, you must authenticate it first.</p>
<h5 id="returns"><a class="doc-anchor" href="#returns">§</a>Returns</h5>
<p>If all provided data is successfully inserted into the database, returns <code>Ok(())</code>. If any
error occurred, the error is logged, and the return value is the height of the first leaf
which failed to be inserted.</p>
</div></details></div><h2 id="dyn-compatibility" class="section-header">Dyn Compatibility<a href="#dyn-compatibility" class="anchor">§</a></h2><div class="dyn-compatibility-info"><p>This trait is <b>not</b> <a href="https://doc.rust-lang.org/1.84.1/reference/items/traits.html#object-safety">dyn compatible</a>.</p><p><i>In older versions of Rust, dyn compatibility was called "object safety", so this trait is not object safe.</i></p></div><h2 id="implementors" class="section-header">Implementors<a href="#implementors" class="anchor">§</a></h2><div id="implementors-list"><section id="impl-UpdateDataSource%3CTypes%3E-for-T" class="impl"><a class="src rightside" href="../../../src/hotshot_query_service/data_source/update.rs.html#90-187">Source</a><a href="#impl-UpdateDataSource%3CTypes%3E-for-T" class="anchor">§</a><h3 class="code-header">impl&lt;Types: <a class="trait" href="../../../hotshot_types/traits/node_implementation/trait.NodeType.html" title="trait hotshot_types::traits::node_implementation::NodeType">NodeType</a>, T&gt; <a class="trait" href="trait.UpdateDataSource.html" title="trait hotshot_query_service::data_source::update::UpdateDataSource">UpdateDataSource</a>&lt;Types&gt; for T<div class="where">where
    T: <a class="trait" href="../../availability/data_source/trait.UpdateAvailabilityData.html" title="trait hotshot_query_service::availability::data_source::UpdateAvailabilityData">UpdateAvailabilityData</a>&lt;Types&gt; + <a class="trait" href="https://doc.rust-lang.org/1.84.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + <a class="trait" href="https://doc.rust-lang.org/1.84.1/core/marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a>,
    <a class="type" href="../../type.Payload.html" title="type hotshot_query_service::Payload">Payload</a>&lt;Types&gt;: <a class="trait" href="../../availability/query_data/trait.QueryablePayload.html" title="trait hotshot_query_service::availability::query_data::QueryablePayload">QueryablePayload</a>&lt;Types&gt;,</div></h3></section></div><script src="../../../trait.impl/hotshot_query_service/data_source/update/trait.UpdateDataSource.js" async></script></section></div></main></body></html>